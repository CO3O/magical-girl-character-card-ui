{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/src/魔法少女猎取计划/界面/状态栏/avatarLibrary.ts","src://tavern_helper_template/node_modules/@vueuse/shared/index.mjs","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/魔法少女猎取计划/脚本/变量结构/index.ts","src://tavern_helper_template/src/魔法少女猎取计划/界面/状态栏/store.ts","src://tavern_helper_template/util/mvu.ts","webpack://tavern_helper_template/./src/魔法少女猎取计划/界面/状态栏/components/CharacterArchivePanel.vue?75e0","webpack://tavern_helper_template/src/魔法少女猎取计划/界面/状态栏/components/CharacterArchivePanel.vue?eab9","webpack://tavern_helper_template/./src/魔法少女猎取计划/界面/状态栏/components/CharacterDetailPanel.vue?445d","webpack://tavern_helper_template/src/魔法少女猎取计划/界面/状态栏/components/CharacterDetailPanel.vue?8637","webpack://tavern_helper_template/./src/魔法少女猎取计划/界面/状态栏/components/CharactersPanel.vue?ff37","webpack://tavern_helper_template/src/魔法少女猎取计划/界面/状态栏/components/CharactersPanel.vue?83e6","webpack://tavern_helper_template/./src/魔法少女猎取计划/界面/状态栏/components/SkillsPanel.vue?4d8c","webpack://tavern_helper_template/src/魔法少女猎取计划/界面/状态栏/components/SkillsPanel.vue?9cb4","webpack://tavern_helper_template/./src/魔法少女猎取计划/界面/状态栏/components/StoryPanel.vue?fa73","webpack://tavern_helper_template/src/魔法少女猎取计划/界面/状态栏/components/StoryPanel.vue?1bae","webpack://tavern_helper_template/./src/魔法少女猎取计划/界面/状态栏/App.vue?b1e8","webpack://tavern_helper_template/src/魔法少女猎取计划/界面/状态栏/App.vue?48d6","src://tavern_helper_template/src/魔法少女猎取计划/界面/状态栏/index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","export interface AvatarLibrary {\n  [characterName: string]: {\n    [avatarId: number]: string;\n  };\n}\n\nexport interface AvatarState {\n  [characterName: string]: {\n    current: number;\n    history: number[];\n  };\n}\n\nconst DB_NAME = 'AvatarLibraryDB';\nconst STORE_NAME = 'avatars';\nconst AVATAR_STATE_KEY = 'avatarState';\nconst AVATAR_LIBRARY_KEY = 'avatarLibrary';\nconst DB_VERSION = 1;\n\nconst defaultAvatarLibrary: AvatarLibrary = {\n  default: {\n    0: '',\n  },\n};\n\nconst defaultAvatarState: AvatarState = {};\n\nlet avatarLibrary: AvatarLibrary = { ...defaultAvatarLibrary };\nlet avatarState: AvatarState = { ...defaultAvatarState };\nlet isInitialized = false;\nlet db: IDBDatabase | null = null;\n\nfunction openDatabase(): Promise<IDBDatabase> {\n  return new Promise((resolve, reject) => {\n    if (db) {\n      resolve(db);\n      return;\n    }\n\n    const request = indexedDB.open(DB_NAME, DB_VERSION);\n\n    request.onerror = () => {\n      console.error('打开 IndexedDB 失败:', request.error);\n      reject(request.error);\n    };\n\n    request.onsuccess = () => {\n      db = request.result;\n      console.log('IndexedDB 连接成功');\n      resolve(db);\n    };\n\n    request.onupgradeneeded = event => {\n      const database = (event.target as IDBOpenDBRequest).result;\n      if (!database.objectStoreNames.contains(STORE_NAME)) {\n        database.createObjectStore(STORE_NAME);\n        console.log('创建 IndexedDB 存储对象:', STORE_NAME);\n      }\n    };\n  });\n}\n\nasync function loadFromIndexedDB<T>(key: string): Promise<T | null> {\n  try {\n    const database = await openDatabase();\n    return new Promise((resolve, reject) => {\n      const transaction = database.transaction([STORE_NAME], 'readonly');\n      const store = transaction.objectStore(STORE_NAME);\n      const request = store.get(key);\n\n      request.onsuccess = () => {\n        resolve(request.result || null);\n      };\n\n      request.onerror = () => {\n        console.error(`从 IndexedDB 读取 ${key} 失败:`, request.error);\n        reject(request.error);\n      };\n    });\n  } catch (error) {\n    console.error(`加载 IndexedDB ${key} 数据失败:`, error);\n    return null;\n  }\n}\n\nasync function saveToIndexedDB<T>(key: string, data: T): Promise<void> {\n  try {\n    const database = await openDatabase();\n    return new Promise((resolve, reject) => {\n      const transaction = database.transaction([STORE_NAME], 'readwrite');\n      const store = transaction.objectStore(STORE_NAME);\n      const request = store.put(data, key);\n\n      request.onsuccess = () => {\n        console.log(`保存 ${key} 到 IndexedDB 成功`);\n        resolve();\n      };\n\n      request.onerror = () => {\n        console.error(`保存 ${key} 到 IndexedDB 失败:`, request.error);\n        reject(request.error);\n      };\n    });\n  } catch (error) {\n    console.error(`保存 IndexedDB ${key} 数据失败:`, error);\n  }\n}\n\nasync function initAvatarLibrary() {\n  if (isInitialized) return;\n\n  try {\n    const savedLibrary = await loadFromIndexedDB<AvatarLibrary>(AVATAR_LIBRARY_KEY);\n    if (savedLibrary && typeof savedLibrary === 'object') {\n      avatarLibrary = {\n        ...defaultAvatarLibrary,\n        ...savedLibrary,\n      };\n      console.log('从 IndexedDB 加载头像库成功');\n    } else {\n      console.log('IndexedDB 中未找到头像库数据，使用默认头像库');\n    }\n\n    const savedState = await loadFromIndexedDB<AvatarState>(AVATAR_STATE_KEY);\n    if (savedState && typeof savedState === 'object') {\n      avatarState = {\n        ...defaultAvatarState,\n        ...savedState,\n      };\n      console.log('从 IndexedDB 加载头像状态成功');\n    } else {\n      console.log('IndexedDB 中未找到头像状态数据，使用默认状态');\n    }\n  } catch (error) {\n    console.error('加载头像库失败:', error);\n  }\n\n  isInitialized = true;\n}\n\nexport async function loadAvatarLibrary(): Promise<AvatarLibrary> {\n  if (isInitialized) {\n    return avatarLibrary;\n  }\n\n  try {\n    await openDatabase();\n\n    const savedLibrary = await loadFromIndexedDB<AvatarLibrary>(AVATAR_LIBRARY_KEY);\n    if (savedLibrary && typeof savedLibrary === 'object') {\n      avatarLibrary = {\n        ...defaultAvatarLibrary,\n        ...savedLibrary,\n      };\n      console.log('从 IndexedDB 加载头像库成功');\n    } else {\n      console.log('IndexedDB 中未找到头像库数据，使用默认头像库');\n    }\n\n    const savedState = await loadFromIndexedDB<AvatarState>(AVATAR_STATE_KEY);\n    if (savedState && typeof savedState === 'object') {\n      avatarState = {\n        ...defaultAvatarState,\n        ...savedState,\n      };\n      console.log('从 IndexedDB 加载头像状态成功');\n    } else {\n      console.log('IndexedDB 中未找到头像状态数据，使用默认状态');\n    }\n\n    isInitialized = true;\n  } catch (error) {\n    console.error('加载头像库失败:', error);\n  }\n\n  return avatarLibrary;\n}\n\nexport function getAvatarLibrary(): AvatarLibrary {\n  return avatarLibrary;\n}\n\nexport function getCharacterAvatarLibrary(characterName: string): Record<number, string> {\n  if (avatarLibrary[characterName]) {\n    return avatarLibrary[characterName];\n  }\n\n  const defaultAvatars = avatarLibrary.default;\n  const nonZeroAvatarIds = Object.keys(defaultAvatars)\n    .map(Number)\n    .filter(id => id > 0);\n\n  if (nonZeroAvatarIds.length > 0) {\n    const firstAvatarId = Math.min(...nonZeroAvatarIds);\n    return {\n      0: defaultAvatars[firstAvatarId] || '',\n      [firstAvatarId]: defaultAvatars[firstAvatarId] || '',\n    };\n  }\n\n  return avatarLibrary.default;\n}\n\nexport function getCurrentAvatarId(characterName: string): number {\n  return avatarState[characterName]?.current || 0;\n}\n\nexport function getAvatarHistoryIds(characterName: string): number[] {\n  return avatarState[characterName]?.history || [];\n}\n\nexport function getAvatarUrl(characterName: string, avatarId?: number): string {\n  const actualAvatarId = avatarId !== undefined ? avatarId : getCurrentAvatarId(characterName);\n  const charAvatarLibrary = getCharacterAvatarLibrary(characterName);\n  const avatarUrl = charAvatarLibrary[actualAvatarId];\n\n  if (avatarUrl) {\n    return avatarUrl;\n  }\n\n  if (actualAvatarId === 0 && !avatarLibrary[characterName]) {\n    const defaultAvatars = avatarLibrary.default;\n    const nonZeroAvatarIds = Object.keys(defaultAvatars)\n      .map(Number)\n      .filter(id => id > 0);\n\n    if (nonZeroAvatarIds.length > 0) {\n      const firstAvatarId = Math.min(...nonZeroAvatarIds);\n      return defaultAvatars[firstAvatarId] || '';\n    }\n  }\n\n  return '';\n}\n\nexport async function setCurrentAvatarId(characterName: string, avatarId: number): Promise<void> {\n  if (!avatarState[characterName]) {\n    avatarState[characterName] = { current: 0, history: [] };\n  }\n\n  const currentAvatarValue = avatarState[characterName].current || 0;\n  const history = avatarState[characterName].history || [];\n\n  let newHistory = [...history];\n  if (currentAvatarValue !== 0 && currentAvatarValue !== avatarId && !newHistory.includes(currentAvatarValue)) {\n    newHistory = [currentAvatarValue, ...newHistory].slice(0, 10);\n  }\n\n  if (avatarId !== 0 && !newHistory.includes(avatarId)) {\n    newHistory = [avatarId, ...newHistory].slice(0, 10);\n  }\n\n  avatarState[characterName].current = avatarId;\n  avatarState[characterName].history = newHistory;\n\n  await saveToIndexedDB(AVATAR_STATE_KEY, avatarState);\n}\n\nexport async function addAvatar(characterName: string, avatarId: number, url: string): Promise<void> {\n  if (!avatarLibrary[characterName]) {\n    avatarLibrary[characterName] = {};\n  }\n  avatarLibrary[characterName][avatarId] = url;\n  await saveToIndexedDB(AVATAR_LIBRARY_KEY, avatarLibrary);\n}\n\nexport async function deleteAvatar(characterName: string, avatarId: number): Promise<void> {\n  if (avatarLibrary[characterName] && avatarLibrary[characterName][avatarId] !== undefined) {\n    delete avatarLibrary[characterName][avatarId];\n    await saveToIndexedDB(AVATAR_LIBRARY_KEY, avatarLibrary);\n  }\n\n  if (avatarState[characterName]) {\n    const history = avatarState[characterName].history || [];\n    const newHistory = history.filter(id => id !== avatarId);\n    avatarState[characterName].history = newHistory;\n\n    if (avatarState[characterName].current === avatarId) {\n      avatarState[characterName].current = 0;\n    }\n\n    await saveToIndexedDB(AVATAR_STATE_KEY, avatarState);\n  }\n}\n\nexport async function removeFromHistory(characterName: string, avatarId: number): Promise<void> {\n  if (avatarState[characterName]) {\n    const history = avatarState[characterName].history || [];\n    const newHistory = history.filter(id => id !== avatarId);\n    avatarState[characterName].history = newHistory;\n    await saveToIndexedDB(AVATAR_STATE_KEY, avatarState);\n  }\n}\n\nexport function getNextAvatarId(characterName: string): number {\n  const charAvatarLibrary = getCharacterAvatarLibrary(characterName);\n  const existingIds = Object.keys(charAvatarLibrary)\n    .map(Number)\n    .filter(id => id > 0);\n  if (existingIds.length === 0) {\n    return 1;\n  }\n  return Math.max(...existingIds) + 1;\n}\n\nexport async function clearAvatarLibrary(): Promise<void> {\n  avatarLibrary = { ...defaultAvatarLibrary };\n  avatarState = { ...defaultAvatarState };\n  await saveToIndexedDB(AVATAR_LIBRARY_KEY, avatarLibrary);\n  await saveToIndexedDB(AVATAR_STATE_KEY, avatarState);\n}\n\nexport function exportAvatarLibrary(): string {\n  return JSON.stringify({ library: avatarLibrary, state: avatarState }, null, 2);\n}\n\nexport async function importAvatarLibrary(jsonString: string): Promise<boolean> {\n  try {\n    const imported = JSON.parse(jsonString);\n    if (typeof imported === 'object' && imported !== null) {\n      if (imported.library) {\n        avatarLibrary = { ...defaultAvatarLibrary, ...imported.library };\n        await saveToIndexedDB(AVATAR_LIBRARY_KEY, avatarLibrary);\n      }\n      if (imported.state) {\n        avatarState = { ...defaultAvatarState, ...imported.state };\n        await saveToIndexedDB(AVATAR_STATE_KEY, avatarState);\n      }\n      return true;\n    }\n    return false;\n  } catch (error) {\n    console.error('导入头像库失败:', error);\n    return false;\n  }\n}\n\nconst initialAvatarData: Record<string, string> = {\n  本猫寺绫藏: 'https://files.catbox.moe/bo46fk.png',\n  凰狩院琉璃: 'https://files.catbox.moe/0dizjy.png',\n  久远琴里: 'https://files.catbox.moe/05t4yg.png',\n  克劳迪娅: 'https://files.catbox.moe/tqk6wf.png',\n  铃屋真凉: 'https://files.catbox.moe/11rpcz.png',\n  芦屋道满: 'https://files.catbox.moe/tw18c5.png',\n  莫里娅蒂娜: 'https://files.catbox.moe/plhsmr.png',\n  '妮妙·勒·菲': 'https://files.catbox.moe/6hniu6.png',\n  诺查: 'https://files.catbox.moe/jq5qbb.png',\n  太岁: 'https://files.catbox.moe/5pfvet.png',\n  望月果心: 'https://files.catbox.moe/e5f3ex.png',\n  小银: 'https://files.catbox.moe/60nelp.png',\n  星原樱: 'https://files.catbox.moe/apvesh.png',\n  玉藻: 'https://files.catbox.moe/xnnv8a.png',\n  致远星: 'https://files.catbox.moe/pabavi.png',\n};\n\nexport async function initializeDefaultAvatars(): Promise<void> {\n  await loadAvatarLibrary();\n\n  for (const [characterName, avatarUrl] of Object.entries(initialAvatarData)) {\n    if (!avatarLibrary[characterName]) {\n      avatarLibrary[characterName] = {};\n    }\n\n    if (!avatarLibrary[characterName][1]) {\n      avatarLibrary[characterName][1] = avatarUrl;\n    }\n\n    if (!avatarState[characterName]) {\n      avatarState[characterName] = { current: 1, history: [] };\n    } else if (avatarState[characterName].current === 0) {\n      avatarState[characterName].current = 1;\n    }\n  }\n\n  await saveToIndexedDB(AVATAR_LIBRARY_KEY, avatarLibrary);\n  await saveToIndexedDB(AVATAR_STATE_KEY, avatarState);\n  console.log('初始头像数据初始化完成');\n}\n","import { shallowRef, watchEffect, readonly, watch, customRef, getCurrentScope, onScopeDispose, effectScope, getCurrentInstance, hasInjectionContext, inject, provide, ref, isRef, unref, toValue as toValue$1, computed, reactive, toRefs as toRefs$1, toRef as toRef$1, shallowReadonly, onBeforeMount, nextTick, onBeforeUnmount, onMounted, onUnmounted, isReactive } from 'vue';\n\nfunction computedEager(fn, options) {\n  var _a;\n  const result = shallowRef();\n  watchEffect(() => {\n    result.value = fn();\n  }, {\n    ...options,\n    flush: (_a = options == null ? void 0 : options.flush) != null ? _a : \"sync\"\n  });\n  return readonly(result);\n}\n\nfunction computedWithControl(source, fn, options = {}) {\n  let v = void 0;\n  let track;\n  let trigger;\n  let dirty = true;\n  const update = () => {\n    dirty = true;\n    trigger();\n  };\n  watch(source, update, { flush: \"sync\", ...options });\n  const get = typeof fn === \"function\" ? fn : fn.get;\n  const set = typeof fn === \"function\" ? void 0 : fn.set;\n  const result = customRef((_track, _trigger) => {\n    track = _track;\n    trigger = _trigger;\n    return {\n      get() {\n        if (dirty) {\n          v = get(v);\n          dirty = false;\n        }\n        track();\n        return v;\n      },\n      set(v2) {\n        set == null ? void 0 : set(v2);\n      }\n    };\n  });\n  result.trigger = update;\n  return result;\n}\n\nfunction tryOnScopeDispose(fn) {\n  if (getCurrentScope()) {\n    onScopeDispose(fn);\n    return true;\n  }\n  return false;\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction createEventHook() {\n  const fns = /* @__PURE__ */ new Set();\n  const off = (fn) => {\n    fns.delete(fn);\n  };\n  const clear = () => {\n    fns.clear();\n  };\n  const on = (fn) => {\n    fns.add(fn);\n    const offFn = () => off(fn);\n    tryOnScopeDispose(offFn);\n    return {\n      off: offFn\n    };\n  };\n  const trigger = (...args) => {\n    return Promise.all(Array.from(fns).map((fn) => fn(...args)));\n  };\n  return {\n    on,\n    off,\n    trigger,\n    clear\n  };\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction createGlobalState(stateFactory) {\n  let initialized = false;\n  let state;\n  const scope = effectScope(true);\n  return (...args) => {\n    if (!initialized) {\n      state = scope.run(() => stateFactory(...args));\n      initialized = true;\n    }\n    return state;\n  };\n}\n\nconst localProvidedStateMap = /* @__PURE__ */ new WeakMap();\n\nconst injectLocal = /* @__NO_SIDE_EFFECTS__ */ (...args) => {\n  var _a;\n  const key = args[0];\n  const instance = (_a = getCurrentInstance()) == null ? void 0 : _a.proxy;\n  if (instance == null && !hasInjectionContext())\n    throw new Error(\"injectLocal must be called in setup\");\n  if (instance && localProvidedStateMap.has(instance) && key in localProvidedStateMap.get(instance))\n    return localProvidedStateMap.get(instance)[key];\n  return inject(...args);\n};\n\nfunction provideLocal(key, value) {\n  var _a;\n  const instance = (_a = getCurrentInstance()) == null ? void 0 : _a.proxy;\n  if (instance == null)\n    throw new Error(\"provideLocal must be called in setup\");\n  if (!localProvidedStateMap.has(instance))\n    localProvidedStateMap.set(instance, /* @__PURE__ */ Object.create(null));\n  const localProvidedState = localProvidedStateMap.get(instance);\n  localProvidedState[key] = value;\n  return provide(key, value);\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction createInjectionState(composable, options) {\n  const key = (options == null ? void 0 : options.injectionKey) || Symbol(composable.name || \"InjectionState\");\n  const defaultValue = options == null ? void 0 : options.defaultValue;\n  const useProvidingState = (...args) => {\n    const state = composable(...args);\n    provideLocal(key, state);\n    return state;\n  };\n  const useInjectedState = () => injectLocal(key, defaultValue);\n  return [useProvidingState, useInjectedState];\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction createRef(value, deep) {\n  if (deep === true) {\n    return ref(value);\n  } else {\n    return shallowRef(value);\n  }\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction createSharedComposable(composable) {\n  let subscribers = 0;\n  let state;\n  let scope;\n  const dispose = () => {\n    subscribers -= 1;\n    if (scope && subscribers <= 0) {\n      scope.stop();\n      state = void 0;\n      scope = void 0;\n    }\n  };\n  return (...args) => {\n    subscribers += 1;\n    if (!scope) {\n      scope = effectScope(true);\n      state = scope.run(() => composable(...args));\n    }\n    tryOnScopeDispose(dispose);\n    return state;\n  };\n}\n\nfunction extendRef(ref, extend, { enumerable = false, unwrap = true } = {}) {\n  for (const [key, value] of Object.entries(extend)) {\n    if (key === \"value\")\n      continue;\n    if (isRef(value) && unwrap) {\n      Object.defineProperty(ref, key, {\n        get() {\n          return value.value;\n        },\n        set(v) {\n          value.value = v;\n        },\n        enumerable\n      });\n    } else {\n      Object.defineProperty(ref, key, { value, enumerable });\n    }\n  }\n  return ref;\n}\n\nfunction get(obj, key) {\n  if (key == null)\n    return unref(obj);\n  return unref(obj)[key];\n}\n\nfunction isDefined(v) {\n  return unref(v) != null;\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction makeDestructurable(obj, arr) {\n  if (typeof Symbol !== \"undefined\") {\n    const clone = { ...obj };\n    Object.defineProperty(clone, Symbol.iterator, {\n      enumerable: false,\n      value() {\n        let index = 0;\n        return {\n          next: () => ({\n            value: arr[index++],\n            done: index > arr.length\n          })\n        };\n      }\n    });\n    return clone;\n  } else {\n    return Object.assign([...arr], obj);\n  }\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction reactify(fn, options) {\n  const unrefFn = (options == null ? void 0 : options.computedGetter) === false ? unref : toValue$1;\n  return function(...args) {\n    return computed(() => fn.apply(this, args.map((i) => unrefFn(i))));\n  };\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction reactifyObject(obj, optionsOrKeys = {}) {\n  let keys = [];\n  let options;\n  if (Array.isArray(optionsOrKeys)) {\n    keys = optionsOrKeys;\n  } else {\n    options = optionsOrKeys;\n    const { includeOwnProperties = true } = optionsOrKeys;\n    keys.push(...Object.keys(obj));\n    if (includeOwnProperties)\n      keys.push(...Object.getOwnPropertyNames(obj));\n  }\n  return Object.fromEntries(\n    keys.map((key) => {\n      const value = obj[key];\n      return [\n        key,\n        typeof value === \"function\" ? reactify(value.bind(obj), options) : value\n      ];\n    })\n  );\n}\n\nfunction toReactive(objectRef) {\n  if (!isRef(objectRef))\n    return reactive(objectRef);\n  const proxy = new Proxy({}, {\n    get(_, p, receiver) {\n      return unref(Reflect.get(objectRef.value, p, receiver));\n    },\n    set(_, p, value) {\n      if (isRef(objectRef.value[p]) && !isRef(value))\n        objectRef.value[p].value = value;\n      else\n        objectRef.value[p] = value;\n      return true;\n    },\n    deleteProperty(_, p) {\n      return Reflect.deleteProperty(objectRef.value, p);\n    },\n    has(_, p) {\n      return Reflect.has(objectRef.value, p);\n    },\n    ownKeys() {\n      return Object.keys(objectRef.value);\n    },\n    getOwnPropertyDescriptor() {\n      return {\n        enumerable: true,\n        configurable: true\n      };\n    }\n  });\n  return reactive(proxy);\n}\n\nfunction reactiveComputed(fn) {\n  return toReactive(computed(fn));\n}\n\nfunction reactiveOmit(obj, ...keys) {\n  const flatKeys = keys.flat();\n  const predicate = flatKeys[0];\n  return reactiveComputed(() => typeof predicate === \"function\" ? Object.fromEntries(Object.entries(toRefs$1(obj)).filter(([k, v]) => !predicate(toValue$1(v), k))) : Object.fromEntries(Object.entries(toRefs$1(obj)).filter((e) => !flatKeys.includes(e[0]))));\n}\n\nconst isClient = typeof window !== \"undefined\" && typeof document !== \"undefined\";\nconst isWorker = typeof WorkerGlobalScope !== \"undefined\" && globalThis instanceof WorkerGlobalScope;\nconst isDef = (val) => typeof val !== \"undefined\";\nconst notNullish = (val) => val != null;\nconst assert = (condition, ...infos) => {\n  if (!condition)\n    console.warn(...infos);\n};\nconst toString = Object.prototype.toString;\nconst isObject = (val) => toString.call(val) === \"[object Object]\";\nconst now = () => Date.now();\nconst timestamp = () => +Date.now();\nconst clamp = (n, min, max) => Math.min(max, Math.max(min, n));\nconst noop = () => {\n};\nconst rand = (min, max) => {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\nconst hasOwn = (val, key) => Object.prototype.hasOwnProperty.call(val, key);\nconst isIOS = /* @__PURE__ */ getIsIOS();\nfunction getIsIOS() {\n  var _a, _b;\n  return isClient && ((_a = window == null ? void 0 : window.navigator) == null ? void 0 : _a.userAgent) && (/iP(?:ad|hone|od)/.test(window.navigator.userAgent) || ((_b = window == null ? void 0 : window.navigator) == null ? void 0 : _b.maxTouchPoints) > 2 && /iPad|Macintosh/.test(window == null ? void 0 : window.navigator.userAgent));\n}\n\nfunction toRef(...args) {\n  if (args.length !== 1)\n    return toRef$1(...args);\n  const r = args[0];\n  return typeof r === \"function\" ? readonly(customRef(() => ({ get: r, set: noop }))) : ref(r);\n}\nconst resolveRef = toRef;\n\nfunction reactivePick(obj, ...keys) {\n  const flatKeys = keys.flat();\n  const predicate = flatKeys[0];\n  return reactiveComputed(() => typeof predicate === \"function\" ? Object.fromEntries(Object.entries(toRefs$1(obj)).filter(([k, v]) => predicate(toValue$1(v), k))) : Object.fromEntries(flatKeys.map((k) => [k, toRef(obj, k)])));\n}\n\nfunction refAutoReset(defaultValue, afterMs = 1e4) {\n  return customRef((track, trigger) => {\n    let value = toValue$1(defaultValue);\n    let timer;\n    const resetAfter = () => setTimeout(() => {\n      value = toValue$1(defaultValue);\n      trigger();\n    }, toValue$1(afterMs));\n    tryOnScopeDispose(() => {\n      clearTimeout(timer);\n    });\n    return {\n      get() {\n        track();\n        return value;\n      },\n      set(newValue) {\n        value = newValue;\n        trigger();\n        clearTimeout(timer);\n        timer = resetAfter();\n      }\n    };\n  });\n}\n\nfunction createFilterWrapper(filter, fn) {\n  function wrapper(...args) {\n    return new Promise((resolve, reject) => {\n      Promise.resolve(filter(() => fn.apply(this, args), { fn, thisArg: this, args })).then(resolve).catch(reject);\n    });\n  }\n  return wrapper;\n}\nconst bypassFilter = (invoke) => {\n  return invoke();\n};\nfunction debounceFilter(ms, options = {}) {\n  let timer;\n  let maxTimer;\n  let lastRejector = noop;\n  const _clearTimeout = (timer2) => {\n    clearTimeout(timer2);\n    lastRejector();\n    lastRejector = noop;\n  };\n  let lastInvoker;\n  const filter = (invoke) => {\n    const duration = toValue$1(ms);\n    const maxDuration = toValue$1(options.maxWait);\n    if (timer)\n      _clearTimeout(timer);\n    if (duration <= 0 || maxDuration !== void 0 && maxDuration <= 0) {\n      if (maxTimer) {\n        _clearTimeout(maxTimer);\n        maxTimer = void 0;\n      }\n      return Promise.resolve(invoke());\n    }\n    return new Promise((resolve, reject) => {\n      lastRejector = options.rejectOnCancel ? reject : resolve;\n      lastInvoker = invoke;\n      if (maxDuration && !maxTimer) {\n        maxTimer = setTimeout(() => {\n          if (timer)\n            _clearTimeout(timer);\n          maxTimer = void 0;\n          resolve(lastInvoker());\n        }, maxDuration);\n      }\n      timer = setTimeout(() => {\n        if (maxTimer)\n          _clearTimeout(maxTimer);\n        maxTimer = void 0;\n        resolve(invoke());\n      }, duration);\n    });\n  };\n  return filter;\n}\nfunction throttleFilter(...args) {\n  let lastExec = 0;\n  let timer;\n  let isLeading = true;\n  let lastRejector = noop;\n  let lastValue;\n  let ms;\n  let trailing;\n  let leading;\n  let rejectOnCancel;\n  if (!isRef(args[0]) && typeof args[0] === \"object\")\n    ({ delay: ms, trailing = true, leading = true, rejectOnCancel = false } = args[0]);\n  else\n    [ms, trailing = true, leading = true, rejectOnCancel = false] = args;\n  const clear = () => {\n    if (timer) {\n      clearTimeout(timer);\n      timer = void 0;\n      lastRejector();\n      lastRejector = noop;\n    }\n  };\n  const filter = (_invoke) => {\n    const duration = toValue$1(ms);\n    const elapsed = Date.now() - lastExec;\n    const invoke = () => {\n      return lastValue = _invoke();\n    };\n    clear();\n    if (duration <= 0) {\n      lastExec = Date.now();\n      return invoke();\n    }\n    if (elapsed > duration && (leading || !isLeading)) {\n      lastExec = Date.now();\n      invoke();\n    } else if (trailing) {\n      lastValue = new Promise((resolve, reject) => {\n        lastRejector = rejectOnCancel ? reject : resolve;\n        timer = setTimeout(() => {\n          lastExec = Date.now();\n          isLeading = true;\n          resolve(invoke());\n          clear();\n        }, Math.max(0, duration - elapsed));\n      });\n    }\n    if (!leading && !timer)\n      timer = setTimeout(() => isLeading = true, duration);\n    isLeading = false;\n    return lastValue;\n  };\n  return filter;\n}\nfunction pausableFilter(extendFilter = bypassFilter, options = {}) {\n  const {\n    initialState = \"active\"\n  } = options;\n  const isActive = toRef(initialState === \"active\");\n  function pause() {\n    isActive.value = false;\n  }\n  function resume() {\n    isActive.value = true;\n  }\n  const eventFilter = (...args) => {\n    if (isActive.value)\n      extendFilter(...args);\n  };\n  return { isActive: readonly(isActive), pause, resume, eventFilter };\n}\n\nfunction promiseTimeout(ms, throwOnTimeout = false, reason = \"Timeout\") {\n  return new Promise((resolve, reject) => {\n    if (throwOnTimeout)\n      setTimeout(() => reject(reason), ms);\n    else\n      setTimeout(resolve, ms);\n  });\n}\nfunction identity(arg) {\n  return arg;\n}\nfunction createSingletonPromise(fn) {\n  let _promise;\n  function wrapper() {\n    if (!_promise)\n      _promise = fn();\n    return _promise;\n  }\n  wrapper.reset = async () => {\n    const _prev = _promise;\n    _promise = void 0;\n    if (_prev)\n      await _prev;\n  };\n  return wrapper;\n}\nfunction invoke(fn) {\n  return fn();\n}\nfunction containsProp(obj, ...props) {\n  return props.some((k) => k in obj);\n}\nfunction increaseWithUnit(target, delta) {\n  var _a;\n  if (typeof target === \"number\")\n    return target + delta;\n  const value = ((_a = target.match(/^-?\\d+\\.?\\d*/)) == null ? void 0 : _a[0]) || \"\";\n  const unit = target.slice(value.length);\n  const result = Number.parseFloat(value) + delta;\n  if (Number.isNaN(result))\n    return target;\n  return result + unit;\n}\nfunction pxValue(px) {\n  return px.endsWith(\"rem\") ? Number.parseFloat(px) * 16 : Number.parseFloat(px);\n}\nfunction objectPick(obj, keys, omitUndefined = false) {\n  return keys.reduce((n, k) => {\n    if (k in obj) {\n      if (!omitUndefined || obj[k] !== void 0)\n        n[k] = obj[k];\n    }\n    return n;\n  }, {});\n}\nfunction objectOmit(obj, keys, omitUndefined = false) {\n  return Object.fromEntries(Object.entries(obj).filter(([key, value]) => {\n    return (!omitUndefined || value !== void 0) && !keys.includes(key);\n  }));\n}\nfunction objectEntries(obj) {\n  return Object.entries(obj);\n}\nfunction toArray(value) {\n  return Array.isArray(value) ? value : [value];\n}\n\nfunction cacheStringFunction(fn) {\n  const cache = /* @__PURE__ */ Object.create(null);\n  return (str) => {\n    const hit = cache[str];\n    return hit || (cache[str] = fn(str));\n  };\n}\nconst hyphenateRE = /\\B([A-Z])/g;\nconst hyphenate = cacheStringFunction((str) => str.replace(hyphenateRE, \"-$1\").toLowerCase());\nconst camelizeRE = /-(\\w)/g;\nconst camelize = cacheStringFunction((str) => {\n  return str.replace(camelizeRE, (_, c) => c ? c.toUpperCase() : \"\");\n});\n\nfunction getLifeCycleTarget(target) {\n  return target || getCurrentInstance();\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useDebounceFn(fn, ms = 200, options = {}) {\n  return createFilterWrapper(\n    debounceFilter(ms, options),\n    fn\n  );\n}\n\nfunction refDebounced(value, ms = 200, options = {}) {\n  const debounced = ref(toValue$1(value));\n  const updater = useDebounceFn(() => {\n    debounced.value = value.value;\n  }, ms, options);\n  watch(value, () => updater());\n  return shallowReadonly(debounced);\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction refDefault(source, defaultValue) {\n  return computed({\n    get() {\n      var _a;\n      return (_a = source.value) != null ? _a : defaultValue;\n    },\n    set(value) {\n      source.value = value;\n    }\n  });\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useThrottleFn(fn, ms = 200, trailing = false, leading = true, rejectOnCancel = false) {\n  return createFilterWrapper(\n    throttleFilter(ms, trailing, leading, rejectOnCancel),\n    fn\n  );\n}\n\nfunction refThrottled(value, delay = 200, trailing = true, leading = true) {\n  if (delay <= 0)\n    return value;\n  const throttled = ref(toValue$1(value));\n  const updater = useThrottleFn(() => {\n    throttled.value = value.value;\n  }, delay, trailing, leading);\n  watch(value, () => updater());\n  return throttled;\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction refWithControl(initial, options = {}) {\n  let source = initial;\n  let track;\n  let trigger;\n  const ref = customRef((_track, _trigger) => {\n    track = _track;\n    trigger = _trigger;\n    return {\n      get() {\n        return get();\n      },\n      set(v) {\n        set(v);\n      }\n    };\n  });\n  function get(tracking = true) {\n    if (tracking)\n      track();\n    return source;\n  }\n  function set(value, triggering = true) {\n    var _a, _b;\n    if (value === source)\n      return;\n    const old = source;\n    if (((_a = options.onBeforeChange) == null ? void 0 : _a.call(options, value, old)) === false)\n      return;\n    source = value;\n    (_b = options.onChanged) == null ? void 0 : _b.call(options, value, old);\n    if (triggering)\n      trigger();\n  }\n  const untrackedGet = () => get(false);\n  const silentSet = (v) => set(v, false);\n  const peek = () => get(false);\n  const lay = (v) => set(v, false);\n  return extendRef(\n    ref,\n    {\n      get,\n      set,\n      untrackedGet,\n      silentSet,\n      peek,\n      lay\n    },\n    { enumerable: true }\n  );\n}\nconst controlledRef = refWithControl;\n\nfunction set(...args) {\n  if (args.length === 2) {\n    const [ref, value] = args;\n    ref.value = value;\n  }\n  if (args.length === 3) {\n    const [target, key, value] = args;\n    target[key] = value;\n  }\n}\n\nfunction watchWithFilter(source, cb, options = {}) {\n  const {\n    eventFilter = bypassFilter,\n    ...watchOptions\n  } = options;\n  return watch(\n    source,\n    createFilterWrapper(\n      eventFilter,\n      cb\n    ),\n    watchOptions\n  );\n}\n\nfunction watchPausable(source, cb, options = {}) {\n  const {\n    eventFilter: filter,\n    initialState = \"active\",\n    ...watchOptions\n  } = options;\n  const { eventFilter, pause, resume, isActive } = pausableFilter(filter, { initialState });\n  const stop = watchWithFilter(\n    source,\n    cb,\n    {\n      ...watchOptions,\n      eventFilter\n    }\n  );\n  return { stop, pause, resume, isActive };\n}\n\nfunction syncRef(left, right, ...[options]) {\n  const {\n    flush = \"sync\",\n    deep = false,\n    immediate = true,\n    direction = \"both\",\n    transform = {}\n  } = options || {};\n  const watchers = [];\n  const transformLTR = \"ltr\" in transform && transform.ltr || ((v) => v);\n  const transformRTL = \"rtl\" in transform && transform.rtl || ((v) => v);\n  if (direction === \"both\" || direction === \"ltr\") {\n    watchers.push(watchPausable(\n      left,\n      (newValue) => {\n        watchers.forEach((w) => w.pause());\n        right.value = transformLTR(newValue);\n        watchers.forEach((w) => w.resume());\n      },\n      { flush, deep, immediate }\n    ));\n  }\n  if (direction === \"both\" || direction === \"rtl\") {\n    watchers.push(watchPausable(\n      right,\n      (newValue) => {\n        watchers.forEach((w) => w.pause());\n        left.value = transformRTL(newValue);\n        watchers.forEach((w) => w.resume());\n      },\n      { flush, deep, immediate }\n    ));\n  }\n  const stop = () => {\n    watchers.forEach((w) => w.stop());\n  };\n  return stop;\n}\n\nfunction syncRefs(source, targets, options = {}) {\n  const {\n    flush = \"sync\",\n    deep = false,\n    immediate = true\n  } = options;\n  const targetsArray = toArray(targets);\n  return watch(\n    source,\n    (newValue) => targetsArray.forEach((target) => target.value = newValue),\n    { flush, deep, immediate }\n  );\n}\n\nfunction toRefs(objectRef, options = {}) {\n  if (!isRef(objectRef))\n    return toRefs$1(objectRef);\n  const result = Array.isArray(objectRef.value) ? Array.from({ length: objectRef.value.length }) : {};\n  for (const key in objectRef.value) {\n    result[key] = customRef(() => ({\n      get() {\n        return objectRef.value[key];\n      },\n      set(v) {\n        var _a;\n        const replaceRef = (_a = toValue$1(options.replaceRef)) != null ? _a : true;\n        if (replaceRef) {\n          if (Array.isArray(objectRef.value)) {\n            const copy = [...objectRef.value];\n            copy[key] = v;\n            objectRef.value = copy;\n          } else {\n            const newObject = { ...objectRef.value, [key]: v };\n            Object.setPrototypeOf(newObject, Object.getPrototypeOf(objectRef.value));\n            objectRef.value = newObject;\n          }\n        } else {\n          objectRef.value[key] = v;\n        }\n      }\n    }));\n  }\n  return result;\n}\n\nconst toValue = toValue$1;\nconst resolveUnref = toValue$1;\n\nfunction tryOnBeforeMount(fn, sync = true, target) {\n  const instance = getLifeCycleTarget(target);\n  if (instance)\n    onBeforeMount(fn, target);\n  else if (sync)\n    fn();\n  else\n    nextTick(fn);\n}\n\nfunction tryOnBeforeUnmount(fn, target) {\n  const instance = getLifeCycleTarget(target);\n  if (instance)\n    onBeforeUnmount(fn, target);\n}\n\nfunction tryOnMounted(fn, sync = true, target) {\n  const instance = getLifeCycleTarget(target);\n  if (instance)\n    onMounted(fn, target);\n  else if (sync)\n    fn();\n  else\n    nextTick(fn);\n}\n\nfunction tryOnUnmounted(fn, target) {\n  const instance = getLifeCycleTarget(target);\n  if (instance)\n    onUnmounted(fn, target);\n}\n\nfunction createUntil(r, isNot = false) {\n  function toMatch(condition, { flush = \"sync\", deep = false, timeout, throwOnTimeout } = {}) {\n    let stop = null;\n    const watcher = new Promise((resolve) => {\n      stop = watch(\n        r,\n        (v) => {\n          if (condition(v) !== isNot) {\n            if (stop)\n              stop();\n            else\n              nextTick(() => stop == null ? void 0 : stop());\n            resolve(v);\n          }\n        },\n        {\n          flush,\n          deep,\n          immediate: true\n        }\n      );\n    });\n    const promises = [watcher];\n    if (timeout != null) {\n      promises.push(\n        promiseTimeout(timeout, throwOnTimeout).then(() => toValue$1(r)).finally(() => stop == null ? void 0 : stop())\n      );\n    }\n    return Promise.race(promises);\n  }\n  function toBe(value, options) {\n    if (!isRef(value))\n      return toMatch((v) => v === value, options);\n    const { flush = \"sync\", deep = false, timeout, throwOnTimeout } = options != null ? options : {};\n    let stop = null;\n    const watcher = new Promise((resolve) => {\n      stop = watch(\n        [r, value],\n        ([v1, v2]) => {\n          if (isNot !== (v1 === v2)) {\n            if (stop)\n              stop();\n            else\n              nextTick(() => stop == null ? void 0 : stop());\n            resolve(v1);\n          }\n        },\n        {\n          flush,\n          deep,\n          immediate: true\n        }\n      );\n    });\n    const promises = [watcher];\n    if (timeout != null) {\n      promises.push(\n        promiseTimeout(timeout, throwOnTimeout).then(() => toValue$1(r)).finally(() => {\n          stop == null ? void 0 : stop();\n          return toValue$1(r);\n        })\n      );\n    }\n    return Promise.race(promises);\n  }\n  function toBeTruthy(options) {\n    return toMatch((v) => Boolean(v), options);\n  }\n  function toBeNull(options) {\n    return toBe(null, options);\n  }\n  function toBeUndefined(options) {\n    return toBe(void 0, options);\n  }\n  function toBeNaN(options) {\n    return toMatch(Number.isNaN, options);\n  }\n  function toContains(value, options) {\n    return toMatch((v) => {\n      const array = Array.from(v);\n      return array.includes(value) || array.includes(toValue$1(value));\n    }, options);\n  }\n  function changed(options) {\n    return changedTimes(1, options);\n  }\n  function changedTimes(n = 1, options) {\n    let count = -1;\n    return toMatch(() => {\n      count += 1;\n      return count >= n;\n    }, options);\n  }\n  if (Array.isArray(toValue$1(r))) {\n    const instance = {\n      toMatch,\n      toContains,\n      changed,\n      changedTimes,\n      get not() {\n        return createUntil(r, !isNot);\n      }\n    };\n    return instance;\n  } else {\n    const instance = {\n      toMatch,\n      toBe,\n      toBeTruthy,\n      toBeNull,\n      toBeNaN,\n      toBeUndefined,\n      changed,\n      changedTimes,\n      get not() {\n        return createUntil(r, !isNot);\n      }\n    };\n    return instance;\n  }\n}\nfunction until(r) {\n  return createUntil(r);\n}\n\nfunction defaultComparator(value, othVal) {\n  return value === othVal;\n}\n// @__NO_SIDE_EFFECTS__\nfunction useArrayDifference(...args) {\n  var _a, _b;\n  const list = args[0];\n  const values = args[1];\n  let compareFn = (_a = args[2]) != null ? _a : defaultComparator;\n  const {\n    symmetric = false\n  } = (_b = args[3]) != null ? _b : {};\n  if (typeof compareFn === \"string\") {\n    const key = compareFn;\n    compareFn = (value, othVal) => value[key] === othVal[key];\n  }\n  const diff1 = computed(() => toValue$1(list).filter((x) => toValue$1(values).findIndex((y) => compareFn(x, y)) === -1));\n  if (symmetric) {\n    const diff2 = computed(() => toValue$1(values).filter((x) => toValue$1(list).findIndex((y) => compareFn(x, y)) === -1));\n    return computed(() => symmetric ? [...toValue$1(diff1), ...toValue$1(diff2)] : toValue$1(diff1));\n  } else {\n    return diff1;\n  }\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useArrayEvery(list, fn) {\n  return computed(() => toValue$1(list).every((element, index, array) => fn(toValue$1(element), index, array)));\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useArrayFilter(list, fn) {\n  return computed(() => toValue$1(list).map((i) => toValue$1(i)).filter(fn));\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useArrayFind(list, fn) {\n  return computed(() => toValue$1(\n    toValue$1(list).find((element, index, array) => fn(toValue$1(element), index, array))\n  ));\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useArrayFindIndex(list, fn) {\n  return computed(() => toValue$1(list).findIndex((element, index, array) => fn(toValue$1(element), index, array)));\n}\n\nfunction findLast(arr, cb) {\n  let index = arr.length;\n  while (index-- > 0) {\n    if (cb(arr[index], index, arr))\n      return arr[index];\n  }\n  return void 0;\n}\n// @__NO_SIDE_EFFECTS__\nfunction useArrayFindLast(list, fn) {\n  return computed(() => toValue$1(\n    !Array.prototype.findLast ? findLast(toValue$1(list), (element, index, array) => fn(toValue$1(element), index, array)) : toValue$1(list).findLast((element, index, array) => fn(toValue$1(element), index, array))\n  ));\n}\n\nfunction isArrayIncludesOptions(obj) {\n  return isObject(obj) && containsProp(obj, \"formIndex\", \"comparator\");\n}\n// @__NO_SIDE_EFFECTS__\nfunction useArrayIncludes(...args) {\n  var _a;\n  const list = args[0];\n  const value = args[1];\n  let comparator = args[2];\n  let formIndex = 0;\n  if (isArrayIncludesOptions(comparator)) {\n    formIndex = (_a = comparator.fromIndex) != null ? _a : 0;\n    comparator = comparator.comparator;\n  }\n  if (typeof comparator === \"string\") {\n    const key = comparator;\n    comparator = (element, value2) => element[key] === toValue$1(value2);\n  }\n  comparator = comparator != null ? comparator : (element, value2) => element === toValue$1(value2);\n  return computed(() => toValue$1(list).slice(formIndex).some((element, index, array) => comparator(\n    toValue$1(element),\n    toValue$1(value),\n    index,\n    toValue$1(array)\n  )));\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useArrayJoin(list, separator) {\n  return computed(() => toValue$1(list).map((i) => toValue$1(i)).join(toValue$1(separator)));\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useArrayMap(list, fn) {\n  return computed(() => toValue$1(list).map((i) => toValue$1(i)).map(fn));\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useArrayReduce(list, reducer, ...args) {\n  const reduceCallback = (sum, value, index) => reducer(toValue$1(sum), toValue$1(value), index);\n  return computed(() => {\n    const resolved = toValue$1(list);\n    return args.length ? resolved.reduce(reduceCallback, typeof args[0] === \"function\" ? toValue$1(args[0]()) : toValue$1(args[0])) : resolved.reduce(reduceCallback);\n  });\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useArraySome(list, fn) {\n  return computed(() => toValue$1(list).some((element, index, array) => fn(toValue$1(element), index, array)));\n}\n\nfunction uniq(array) {\n  return Array.from(new Set(array));\n}\nfunction uniqueElementsBy(array, fn) {\n  return array.reduce((acc, v) => {\n    if (!acc.some((x) => fn(v, x, array)))\n      acc.push(v);\n    return acc;\n  }, []);\n}\n// @__NO_SIDE_EFFECTS__\nfunction useArrayUnique(list, compareFn) {\n  return computed(() => {\n    const resolvedList = toValue$1(list).map((element) => toValue$1(element));\n    return compareFn ? uniqueElementsBy(resolvedList, compareFn) : uniq(resolvedList);\n  });\n}\n\nfunction useCounter(initialValue = 0, options = {}) {\n  let _initialValue = unref(initialValue);\n  const count = shallowRef(initialValue);\n  const {\n    max = Number.POSITIVE_INFINITY,\n    min = Number.NEGATIVE_INFINITY\n  } = options;\n  const inc = (delta = 1) => count.value = Math.max(Math.min(max, count.value + delta), min);\n  const dec = (delta = 1) => count.value = Math.min(Math.max(min, count.value - delta), max);\n  const get = () => count.value;\n  const set = (val) => count.value = Math.max(min, Math.min(max, val));\n  const reset = (val = _initialValue) => {\n    _initialValue = val;\n    return set(val);\n  };\n  return { count: shallowReadonly(count), inc, dec, get, set, reset };\n}\n\nconst REGEX_PARSE = /^(\\d{4})[-/]?(\\d{1,2})?[-/]?(\\d{0,2})[T\\s]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?[.:]?(\\d+)?$/i;\nconst REGEX_FORMAT = /[YMDHhms]o|\\[([^\\]]+)\\]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a{1,2}|A{1,2}|m{1,2}|s{1,2}|Z{1,2}|z{1,4}|SSS/g;\nfunction defaultMeridiem(hours, minutes, isLowercase, hasPeriod) {\n  let m = hours < 12 ? \"AM\" : \"PM\";\n  if (hasPeriod)\n    m = m.split(\"\").reduce((acc, curr) => acc += `${curr}.`, \"\");\n  return isLowercase ? m.toLowerCase() : m;\n}\nfunction formatOrdinal(num) {\n  const suffixes = [\"th\", \"st\", \"nd\", \"rd\"];\n  const v = num % 100;\n  return num + (suffixes[(v - 20) % 10] || suffixes[v] || suffixes[0]);\n}\nfunction formatDate(date, formatStr, options = {}) {\n  var _a;\n  const years = date.getFullYear();\n  const month = date.getMonth();\n  const days = date.getDate();\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n  const seconds = date.getSeconds();\n  const milliseconds = date.getMilliseconds();\n  const day = date.getDay();\n  const meridiem = (_a = options.customMeridiem) != null ? _a : defaultMeridiem;\n  const stripTimeZone = (dateString) => {\n    var _a2;\n    return (_a2 = dateString.split(\" \")[1]) != null ? _a2 : \"\";\n  };\n  const matches = {\n    Yo: () => formatOrdinal(years),\n    YY: () => String(years).slice(-2),\n    YYYY: () => years,\n    M: () => month + 1,\n    Mo: () => formatOrdinal(month + 1),\n    MM: () => `${month + 1}`.padStart(2, \"0\"),\n    MMM: () => date.toLocaleDateString(toValue$1(options.locales), { month: \"short\" }),\n    MMMM: () => date.toLocaleDateString(toValue$1(options.locales), { month: \"long\" }),\n    D: () => String(days),\n    Do: () => formatOrdinal(days),\n    DD: () => `${days}`.padStart(2, \"0\"),\n    H: () => String(hours),\n    Ho: () => formatOrdinal(hours),\n    HH: () => `${hours}`.padStart(2, \"0\"),\n    h: () => `${hours % 12 || 12}`.padStart(1, \"0\"),\n    ho: () => formatOrdinal(hours % 12 || 12),\n    hh: () => `${hours % 12 || 12}`.padStart(2, \"0\"),\n    m: () => String(minutes),\n    mo: () => formatOrdinal(minutes),\n    mm: () => `${minutes}`.padStart(2, \"0\"),\n    s: () => String(seconds),\n    so: () => formatOrdinal(seconds),\n    ss: () => `${seconds}`.padStart(2, \"0\"),\n    SSS: () => `${milliseconds}`.padStart(3, \"0\"),\n    d: () => day,\n    dd: () => date.toLocaleDateString(toValue$1(options.locales), { weekday: \"narrow\" }),\n    ddd: () => date.toLocaleDateString(toValue$1(options.locales), { weekday: \"short\" }),\n    dddd: () => date.toLocaleDateString(toValue$1(options.locales), { weekday: \"long\" }),\n    A: () => meridiem(hours, minutes),\n    AA: () => meridiem(hours, minutes, false, true),\n    a: () => meridiem(hours, minutes, true),\n    aa: () => meridiem(hours, minutes, true, true),\n    z: () => stripTimeZone(date.toLocaleDateString(toValue$1(options.locales), { timeZoneName: \"shortOffset\" })),\n    zz: () => stripTimeZone(date.toLocaleDateString(toValue$1(options.locales), { timeZoneName: \"shortOffset\" })),\n    zzz: () => stripTimeZone(date.toLocaleDateString(toValue$1(options.locales), { timeZoneName: \"shortOffset\" })),\n    zzzz: () => stripTimeZone(date.toLocaleDateString(toValue$1(options.locales), { timeZoneName: \"longOffset\" }))\n  };\n  return formatStr.replace(REGEX_FORMAT, (match, $1) => {\n    var _a2, _b;\n    return (_b = $1 != null ? $1 : (_a2 = matches[match]) == null ? void 0 : _a2.call(matches)) != null ? _b : match;\n  });\n}\nfunction normalizeDate(date) {\n  if (date === null)\n    return new Date(Number.NaN);\n  if (date === void 0)\n    return /* @__PURE__ */ new Date();\n  if (date instanceof Date)\n    return new Date(date);\n  if (typeof date === \"string\" && !/Z$/i.test(date)) {\n    const d = date.match(REGEX_PARSE);\n    if (d) {\n      const m = d[2] - 1 || 0;\n      const ms = (d[7] || \"0\").substring(0, 3);\n      return new Date(d[1], m, d[3] || 1, d[4] || 0, d[5] || 0, d[6] || 0, ms);\n    }\n  }\n  return new Date(date);\n}\n// @__NO_SIDE_EFFECTS__\nfunction useDateFormat(date, formatStr = \"HH:mm:ss\", options = {}) {\n  return computed(() => formatDate(normalizeDate(toValue$1(date)), toValue$1(formatStr), options));\n}\n\nfunction useIntervalFn(cb, interval = 1e3, options = {}) {\n  const {\n    immediate = true,\n    immediateCallback = false\n  } = options;\n  let timer = null;\n  const isActive = shallowRef(false);\n  function clean() {\n    if (timer) {\n      clearInterval(timer);\n      timer = null;\n    }\n  }\n  function pause() {\n    isActive.value = false;\n    clean();\n  }\n  function resume() {\n    const intervalValue = toValue$1(interval);\n    if (intervalValue <= 0)\n      return;\n    isActive.value = true;\n    if (immediateCallback)\n      cb();\n    clean();\n    if (isActive.value)\n      timer = setInterval(cb, intervalValue);\n  }\n  if (immediate && isClient)\n    resume();\n  if (isRef(interval) || typeof interval === \"function\") {\n    const stopWatch = watch(interval, () => {\n      if (isActive.value && isClient)\n        resume();\n    });\n    tryOnScopeDispose(stopWatch);\n  }\n  tryOnScopeDispose(pause);\n  return {\n    isActive: shallowReadonly(isActive),\n    pause,\n    resume\n  };\n}\n\nfunction useInterval(interval = 1e3, options = {}) {\n  const {\n    controls: exposeControls = false,\n    immediate = true,\n    callback\n  } = options;\n  const counter = shallowRef(0);\n  const update = () => counter.value += 1;\n  const reset = () => {\n    counter.value = 0;\n  };\n  const controls = useIntervalFn(\n    callback ? () => {\n      update();\n      callback(counter.value);\n    } : update,\n    interval,\n    { immediate }\n  );\n  if (exposeControls) {\n    return {\n      counter: shallowReadonly(counter),\n      reset,\n      ...controls\n    };\n  } else {\n    return shallowReadonly(counter);\n  }\n}\n\nfunction useLastChanged(source, options = {}) {\n  var _a;\n  const ms = shallowRef((_a = options.initialValue) != null ? _a : null);\n  watch(\n    source,\n    () => ms.value = timestamp(),\n    options\n  );\n  return shallowReadonly(ms);\n}\n\nfunction useTimeoutFn(cb, interval, options = {}) {\n  const {\n    immediate = true,\n    immediateCallback = false\n  } = options;\n  const isPending = shallowRef(false);\n  let timer;\n  function clear() {\n    if (timer) {\n      clearTimeout(timer);\n      timer = void 0;\n    }\n  }\n  function stop() {\n    isPending.value = false;\n    clear();\n  }\n  function start(...args) {\n    if (immediateCallback)\n      cb();\n    clear();\n    isPending.value = true;\n    timer = setTimeout(() => {\n      isPending.value = false;\n      timer = void 0;\n      cb(...args);\n    }, toValue$1(interval));\n  }\n  if (immediate) {\n    isPending.value = true;\n    if (isClient)\n      start();\n  }\n  tryOnScopeDispose(stop);\n  return {\n    isPending: shallowReadonly(isPending),\n    start,\n    stop\n  };\n}\n\nfunction useTimeout(interval = 1e3, options = {}) {\n  const {\n    controls: exposeControls = false,\n    callback\n  } = options;\n  const controls = useTimeoutFn(\n    callback != null ? callback : noop,\n    interval,\n    options\n  );\n  const ready = computed(() => !controls.isPending.value);\n  if (exposeControls) {\n    return {\n      ready,\n      ...controls\n    };\n  } else {\n    return ready;\n  }\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useToNumber(value, options = {}) {\n  const {\n    method = \"parseFloat\",\n    radix,\n    nanToZero\n  } = options;\n  return computed(() => {\n    let resolved = toValue$1(value);\n    if (typeof method === \"function\")\n      resolved = method(resolved);\n    else if (typeof resolved === \"string\")\n      resolved = Number[method](resolved, radix);\n    if (nanToZero && Number.isNaN(resolved))\n      resolved = 0;\n    return resolved;\n  });\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useToString(value) {\n  return computed(() => `${toValue$1(value)}`);\n}\n\n// @__NO_SIDE_EFFECTS__\nfunction useToggle(initialValue = false, options = {}) {\n  const {\n    truthyValue = true,\n    falsyValue = false\n  } = options;\n  const valueIsRef = isRef(initialValue);\n  const _value = shallowRef(initialValue);\n  function toggle(value) {\n    if (arguments.length) {\n      _value.value = value;\n      return _value.value;\n    } else {\n      const truthy = toValue$1(truthyValue);\n      _value.value = _value.value === truthy ? toValue$1(falsyValue) : truthy;\n      return _value.value;\n    }\n  }\n  if (valueIsRef)\n    return toggle;\n  else\n    return [_value, toggle];\n}\n\nfunction watchArray(source, cb, options) {\n  let oldList = (options == null ? void 0 : options.immediate) ? [] : [...typeof source === \"function\" ? source() : Array.isArray(source) ? source : toValue$1(source)];\n  return watch(source, (newList, _, onCleanup) => {\n    const oldListRemains = Array.from({ length: oldList.length });\n    const added = [];\n    for (const obj of newList) {\n      let found = false;\n      for (let i = 0; i < oldList.length; i++) {\n        if (!oldListRemains[i] && obj === oldList[i]) {\n          oldListRemains[i] = true;\n          found = true;\n          break;\n        }\n      }\n      if (!found)\n        added.push(obj);\n    }\n    const removed = oldList.filter((_2, i) => !oldListRemains[i]);\n    cb(newList, oldList, added, removed, onCleanup);\n    oldList = [...newList];\n  }, options);\n}\n\nfunction watchAtMost(source, cb, options) {\n  const {\n    count,\n    ...watchOptions\n  } = options;\n  const current = shallowRef(0);\n  const stop = watchWithFilter(\n    source,\n    (...args) => {\n      current.value += 1;\n      if (current.value >= toValue$1(count))\n        nextTick(() => stop());\n      cb(...args);\n    },\n    watchOptions\n  );\n  return { count: current, stop };\n}\n\nfunction watchDebounced(source, cb, options = {}) {\n  const {\n    debounce = 0,\n    maxWait = void 0,\n    ...watchOptions\n  } = options;\n  return watchWithFilter(\n    source,\n    cb,\n    {\n      ...watchOptions,\n      eventFilter: debounceFilter(debounce, { maxWait })\n    }\n  );\n}\n\nfunction watchDeep(source, cb, options) {\n  return watch(\n    source,\n    cb,\n    {\n      ...options,\n      deep: true\n    }\n  );\n}\n\nfunction watchIgnorable(source, cb, options = {}) {\n  const {\n    eventFilter = bypassFilter,\n    ...watchOptions\n  } = options;\n  const filteredCb = createFilterWrapper(\n    eventFilter,\n    cb\n  );\n  let ignoreUpdates;\n  let ignorePrevAsyncUpdates;\n  let stop;\n  if (watchOptions.flush === \"sync\") {\n    let ignore = false;\n    ignorePrevAsyncUpdates = () => {\n    };\n    ignoreUpdates = (updater) => {\n      ignore = true;\n      updater();\n      ignore = false;\n    };\n    stop = watch(\n      source,\n      (...args) => {\n        if (!ignore)\n          filteredCb(...args);\n      },\n      watchOptions\n    );\n  } else {\n    const disposables = [];\n    let ignoreCounter = 0;\n    let syncCounter = 0;\n    ignorePrevAsyncUpdates = () => {\n      ignoreCounter = syncCounter;\n    };\n    disposables.push(\n      watch(\n        source,\n        () => {\n          syncCounter++;\n        },\n        { ...watchOptions, flush: \"sync\" }\n      )\n    );\n    ignoreUpdates = (updater) => {\n      const syncCounterPrev = syncCounter;\n      updater();\n      ignoreCounter += syncCounter - syncCounterPrev;\n    };\n    disposables.push(\n      watch(\n        source,\n        (...args) => {\n          const ignore = ignoreCounter > 0 && ignoreCounter === syncCounter;\n          ignoreCounter = 0;\n          syncCounter = 0;\n          if (ignore)\n            return;\n          filteredCb(...args);\n        },\n        watchOptions\n      )\n    );\n    stop = () => {\n      disposables.forEach((fn) => fn());\n    };\n  }\n  return { stop, ignoreUpdates, ignorePrevAsyncUpdates };\n}\n\nfunction watchImmediate(source, cb, options) {\n  return watch(\n    source,\n    cb,\n    {\n      ...options,\n      immediate: true\n    }\n  );\n}\n\nfunction watchOnce(source, cb, options) {\n  return watch(\n    source,\n    cb,\n    {\n      ...options,\n      once: true\n    }\n  );\n}\n\nfunction watchThrottled(source, cb, options = {}) {\n  const {\n    throttle = 0,\n    trailing = true,\n    leading = true,\n    ...watchOptions\n  } = options;\n  return watchWithFilter(\n    source,\n    cb,\n    {\n      ...watchOptions,\n      eventFilter: throttleFilter(throttle, trailing, leading)\n    }\n  );\n}\n\nfunction watchTriggerable(source, cb, options = {}) {\n  let cleanupFn;\n  function onEffect() {\n    if (!cleanupFn)\n      return;\n    const fn = cleanupFn;\n    cleanupFn = void 0;\n    fn();\n  }\n  function onCleanup(callback) {\n    cleanupFn = callback;\n  }\n  const _cb = (value, oldValue) => {\n    onEffect();\n    return cb(value, oldValue, onCleanup);\n  };\n  const res = watchIgnorable(source, _cb, options);\n  const { ignoreUpdates } = res;\n  const trigger = () => {\n    let res2;\n    ignoreUpdates(() => {\n      res2 = _cb(getWatchSources(source), getOldValue(source));\n    });\n    return res2;\n  };\n  return {\n    ...res,\n    trigger\n  };\n}\nfunction getWatchSources(sources) {\n  if (isReactive(sources))\n    return sources;\n  if (Array.isArray(sources))\n    return sources.map((item) => toValue$1(item));\n  return toValue$1(sources);\n}\nfunction getOldValue(source) {\n  return Array.isArray(source) ? source.map(() => void 0) : void 0;\n}\n\nfunction whenever(source, cb, options) {\n  const stop = watch(\n    source,\n    (v, ov, onInvalidate) => {\n      if (v) {\n        if (options == null ? void 0 : options.once)\n          nextTick(() => stop());\n        cb(v, ov, onInvalidate);\n      }\n    },\n    {\n      ...options,\n      once: false\n    }\n  );\n  return stop;\n}\n\nexport { assert, refAutoReset as autoResetRef, bypassFilter, camelize, clamp, computedEager, computedWithControl, containsProp, computedWithControl as controlledComputed, controlledRef, createEventHook, createFilterWrapper, createGlobalState, createInjectionState, reactify as createReactiveFn, createRef, createSharedComposable, createSingletonPromise, debounceFilter, refDebounced as debouncedRef, watchDebounced as debouncedWatch, computedEager as eagerComputed, extendRef, formatDate, get, getLifeCycleTarget, hasOwn, hyphenate, identity, watchIgnorable as ignorableWatch, increaseWithUnit, injectLocal, invoke, isClient, isDef, isDefined, isIOS, isObject, isWorker, makeDestructurable, noop, normalizeDate, notNullish, now, objectEntries, objectOmit, objectPick, pausableFilter, watchPausable as pausableWatch, promiseTimeout, provideLocal, pxValue, rand, reactify, reactifyObject, reactiveComputed, reactiveOmit, reactivePick, refAutoReset, refDebounced, refDefault, refThrottled, refWithControl, resolveRef, resolveUnref, set, syncRef, syncRefs, throttleFilter, refThrottled as throttledRef, watchThrottled as throttledWatch, timestamp, toArray, toReactive, toRef, toRefs, toValue, tryOnBeforeMount, tryOnBeforeUnmount, tryOnMounted, tryOnScopeDispose, tryOnUnmounted, until, useArrayDifference, useArrayEvery, useArrayFilter, useArrayFind, useArrayFindIndex, useArrayFindLast, useArrayIncludes, useArrayJoin, useArrayMap, useArrayReduce, useArraySome, useArrayUnique, useCounter, useDateFormat, refDebounced as useDebounce, useDebounceFn, useInterval, useIntervalFn, useLastChanged, refThrottled as useThrottle, useThrottleFn, useTimeout, useTimeoutFn, useToNumber, useToString, useToggle, watchArray, watchAtMost, watchDebounced, watchDeep, watchIgnorable, watchImmediate, watchOnce, watchPausable, watchThrottled, watchTriggerable, watchWithFilter, whenever };\n","const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { registerMvuSchema } from 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js';\nconst CharacterStatsSchema = z.object({\n    Favor: z.coerce\n        .number()\n        .transform(v => _.clamp(v, -100, 100))\n        .prefault(0), // 好感度，范围-100到100\n    Magic: z.coerce.number().prefault(100), // 当前魔力值\n    MagicMax: z.coerce.number().prefault(100), // 魔力值上限\n    Corruption: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(0), // 堕落值，范围0到100\n    Description: z.array(z.string()).prefault([]), // 角色身份背景介绍（分类数组）\n});\n// 接着是角色在场景中的临时状态结构\nconst SceneCharacterSchema = z.object({\n    Thought: z.string().prefault(''), // 角色当前想法\n    Action: z.string().prefault(''), // 角色当前动作\n    State: z.string().prefault('正常'), // 角色状态（正常、受伤、疲劳等）\n    isTransformed: z.boolean().prefault(false), // 是否已变身\n    Lust: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(0), // 欲望值，范围0到100\n});\n// 这是我们将要使用的完整变量结构\nexport const Schema = z.object({\n    当前时间: z.string().prefault('2024年03月17日 星期二 16:45'), // 游戏内当前时间\n    location: z.string().prefault('远谷町-垂枝樱学园-二年3班教室'), // 当前位置\n    个人线: z\n        .record(z.string().describe('角色个人线名称'), z.object({\n        状态: z.string().prefault('未开始'), // 个人线状态（未开始、进行中、已完成）\n        结局: z\n            .record(z.string().describe('结局名称'), z.object({\n            说明: z.string().prefault(''), // 结局说明\n            达成条件: z.record(z.string().describe('条件名称'), z.boolean().prefault(false)).prefault({}), // 结局达成条件\n        }))\n            .prefault({}),\n    }))\n        .prefault({}),\n    // 储存所有角色的永久数据\n    角色列表: z.record(z.string().describe('角色名'), CharacterStatsSchema).prefault({}),\n    // 储存当前场景中出现的角色的临时状态\n    在场角色: z.record(z.string().describe('角色名'), SceneCharacterSchema).prefault({}),\n    Enemies: z.record(z.string().describe('敌人名'), z.any()).prefault({}), // 敌人列表\n    Partners: z.record(z.string().describe('同伴名'), z.any()).prefault({}), // 同伴列表\n    // 哥哥你的专属数据\n    user: z\n        .object({\n        SkillPoint: z.coerce.number().prefault(10), // 技能点（侵蚀点）\n        Magic: z.coerce.number().prefault(100), // 当前魔力值\n        MagicMax: z.coerce.number().prefault(100), // 魔力值上限\n        Morality: z.coerce\n            .number()\n            .transform(v => _.clamp(v, -100, 100))\n            .prefault(0), // 善恶值，范围-100到100\n        SkillTree: z\n            .record(z.string().describe('技能名'), z.object({\n            描述: z.string().prefault(''), // 技能描述\n            消耗: z.coerce.number().prefault(0), // 学习消耗的技能点\n            已学习: z.boolean().prefault(false), // 是否已学习该技能\n        }))\n            .prefault({}), // 技能树\n    })\n        .prefault({\n        SkillPoint: 10,\n        Magic: 100,\n        MagicMax: 100,\n        Morality: 0,\n        SkillTree: {},\n    }),\n});\n$(() => {\n    registerMvuSchema(Schema);\n});\n","import { defineMvuDataStore } from '@util/mvu';\nimport { Schema } from '../../脚本/变量结构/index';\n\nexport const useDataStore = defineMvuDataStore(Schema, { type: 'message', message_id: getCurrentMessageId() });\n","export function defineMvuDataStore(schema, variable_option, additional_setup) {\n    if (variable_option.type === 'message' &&\n        (variable_option.message_id === undefined || variable_option.message_id === 'latest')) {\n        variable_option.message_id = -1;\n    }\n    return defineStore(`mvu_data.${_(variable_option)\n        .entries()\n        .sortBy(entry => entry[0])\n        .map(entry => entry[1])\n        .join('.')}`, errorCatched(() => {\n        const data = ref(schema.parse(_.get(getVariables(variable_option), 'stat_data', {}), { reportInput: true }));\n        if (additional_setup) {\n            additional_setup(data);\n        }\n        useIntervalFn(() => {\n            const stat_data = _.get(getVariables(variable_option), 'stat_data', {});\n            const result = schema.safeParse(stat_data);\n            if (result.error) {\n                return;\n            }\n            if (!_.isEqual(data.value, result.data)) {\n                ignoreUpdates(() => {\n                    data.value = result.data;\n                });\n                if (!_.isEqual(stat_data, result.data)) {\n                    updateVariablesWith(variables => _.set(variables, 'stat_data', result.data), variable_option);\n                }\n            }\n        }, 2000);\n        const { ignoreUpdates } = watchIgnorable(data, new_data => {\n            const result = schema.safeParse(new_data);\n            if (result.error) {\n                return;\n            }\n            if (!_.isEqual(new_data, result.data)) {\n                ignoreUpdates(() => {\n                    data.value = result.data;\n                });\n            }\n            updateVariablesWith(variables => _.set(variables, 'stat_data', result.data), variable_option);\n        }, { deep: true });\n        return { data };\n    }));\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"character-archive\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"character-grid\"\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"character-avatar\" };\nconst _hoisted_6 = [\"src\", \"alt\"];\nconst _hoisted_7 = {\n    key: 1,\n    class: \"avatar-placeholder\"\n};\nconst _hoisted_8 = { class: \"character-info\" };\nconst _hoisted_9 = { class: \"character-name\" };\nconst _hoisted_10 = { class: \"character-stats\" };\nconst _hoisted_11 = { class: \"stat-item\" };\nconst _hoisted_12 = { class: \"stat-item\" };\nconst _hoisted_13 = { class: \"stat-item\" };\nimport { computed } from 'vue';\nimport { getAvatarUrl as getAvatarUrlFromLibrary, getCurrentAvatarId } from '../avatarLibrary';\nimport { useDataStore } from '../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterArchivePanel',\n    emits: [\"view-character\"],\n    setup(__props, { emit: __emit }) {\n        const dataStore = useDataStore();\n        const emit = __emit;\n        const allCharacters = computed(() => {\n            return dataStore.data.角色列表 || {};\n        });\n        const presentCharacters = computed(() => {\n            return dataStore.data.在场角色 || {};\n        });\n        function getAvatarUrl(characterName) {\n            const avatarId = getCurrentAvatarId(characterName);\n            return getAvatarUrlFromLibrary(characterName, avatarId);\n        }\n        // 检查角色是否在场\n        function isPresent(name) {\n            return name in presentCharacters.value;\n        }\n        // 获取在场状态样式类\n        function getPresenceClass(name) {\n            return isPresent(name) ? 'present' : 'absent';\n        }\n        // 获取在场状态文本\n        function getPresenceText(name) {\n            return isPresent(name) ? '在场' : '不在场';\n        }\n        // 查看角色详情\n        function viewCharacter(name) {\n            emit('view-character', name);\n        }\n        // 处理图片加载失败\n        function handleImageError(event) {\n            const img = event.target;\n            img.style.display = 'none';\n            const placeholder = img.parentElement?.querySelector('.avatar-placeholder');\n            if (placeholder) {\n                placeholder.style.display = 'flex';\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (Object.keys(allCharacters.value).length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"暂无角色数据\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(allCharacters.value, (character, name) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: name,\n                                class: \"character-card\",\n                                onClick: ($event) => (viewCharacter(name))\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_5, [\n                                    (getAvatarUrl(name))\n                                        ? (_openBlock(), _createElementBlock(\"img\", {\n                                            key: 0,\n                                            src: getAvatarUrl(name),\n                                            alt: name,\n                                            onError: handleImageError\n                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_6))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [...(_cache[1] || (_cache[1] = [\n                                                _createElementVNode(\"i\", { class: \"fas fa-user\" }, null, -1 /* CACHED */)\n                                            ]))]))\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_8, [\n                                    _createElementVNode(\"h3\", _hoisted_9, _toDisplayString(name), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_10, [\n                                        _createElementVNode(\"div\", _hoisted_11, [\n                                            _cache[2] || (_cache[2] = _createElementVNode(\"i\", {\n                                                class: \"fas fa-heart\",\n                                                style: { \"color\": \"var(--pink)\" }\n                                            }, null, -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", null, _toDisplayString(character.Favor) + \"%\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_12, [\n                                            _cache[3] || (_cache[3] = _createElementVNode(\"i\", {\n                                                class: \"fas fa-bolt\",\n                                                style: { \"color\": \"var(--green)\" }\n                                            }, null, -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", null, _toDisplayString(character.Magic) + \"/\" + _toDisplayString(character.MagicMax), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_13, [\n                                            _cache[4] || (_cache[4] = _createElementVNode(\"i\", {\n                                                class: \"fas fa-skull-crossbones\",\n                                                style: { \"color\": \"var(--purple)\" }\n                                            }, null, -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", null, _toDisplayString(character.Corruption) + \"%\", 1 /* TEXT */)\n                                        ])\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", {\n                                    class: _normalizeClass([\"character-status-badge\", getPresenceClass(name)])\n                                }, _toDisplayString(getPresenceText(name)), 3 /* TEXT, CLASS */)\n                            ], 8 /* PROPS */, _hoisted_4));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterArchivePanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterArchivePanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterArchivePanel.vue?vue&type=style&index=0&id=393b741d&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-393b741d\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, withModifiers as _withModifiers, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"character-detail-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"loading\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"character-detail-content\"\n};\nconst _hoisted_4 = { class: \"avatar-section\" };\nconst _hoisted_5 = { class: \"avatar-banner\" };\nconst _hoisted_6 = [\"src\", \"alt\"];\nconst _hoisted_7 = {\n    key: 1,\n    class: \"avatar-placeholder-large\"\n};\nconst _hoisted_8 = { class: \"avatar-bottom-content\" };\nconst _hoisted_9 = { class: \"avatar-text-wrapper\" };\nconst _hoisted_10 = { class: \"character-title\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"avatar-history\"\n};\nconst _hoisted_12 = { class: \"history-list\" };\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = [\"src\", \"alt\"];\nconst _hoisted_15 = [\"onClick\"];\nconst _hoisted_16 = { class: \"char-card\" };\nconst _hoisted_17 = { class: \"char-details\" };\nconst _hoisted_18 = { class: \"detail-item\" };\nconst _hoisted_19 = { class: \"detail-item\" };\nconst _hoisted_20 = { class: \"detail-item\" };\nconst _hoisted_21 = {\n    key: 0,\n    class: \"stat-bar-container\"\n};\nconst _hoisted_22 = { class: \"stat-bar-label\" };\nconst _hoisted_23 = { class: \"stat-bar-value\" };\nconst _hoisted_24 = { class: \"progress-bar\" };\nconst _hoisted_25 = {\n    key: 1,\n    class: \"stat-bar-container\"\n};\nconst _hoisted_26 = { class: \"stat-bar-label\" };\nconst _hoisted_27 = { class: \"stat-bar-value\" };\nconst _hoisted_28 = { class: \"progress-bar\" };\nconst _hoisted_29 = {\n    key: 2,\n    class: \"stat-bar-container\"\n};\nconst _hoisted_30 = { class: \"stat-bar-label\" };\nconst _hoisted_31 = { class: \"stat-bar-value\" };\nconst _hoisted_32 = { class: \"progress-bar\" };\nconst _hoisted_33 = {\n    key: 3,\n    class: \"stat-bar-container\"\n};\nconst _hoisted_34 = { class: \"stat-bar-label\" };\nconst _hoisted_35 = { class: \"stat-bar-value\" };\nconst _hoisted_36 = { class: \"progress-bar\" };\nconst _hoisted_37 = {\n    key: 4,\n    class: \"thought-block\"\n};\nconst _hoisted_38 = {\n    key: 0,\n    class: \"char-card description-card\"\n};\nconst _hoisted_39 = { class: \"description-content\" };\nimport { computed, ref, watch } from 'vue';\nimport { addAvatar, deleteAvatar as deleteAvatarFromLibrary, getAvatarHistoryIds, getAvatarUrl, getCharacterAvatarLibrary, getCurrentAvatarId, getNextAvatarId, removeFromHistory, setCurrentAvatarId, } from '../avatarLibrary';\nimport { useDataStore } from '../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterDetailPanel',\n    props: {\n        characterName: {}\n    },\n    setup(__props) {\n        let isAvatarOptionsDialogOpen = false;\n        let currentDialogElement = null;\n        const props = __props;\n        const dataStore = useDataStore();\n        const characterData = computed(() => {\n            return dataStore.data.角色列表?.[props.characterName];\n        });\n        const sceneData = computed(() => {\n            return dataStore.data.在场角色?.[props.characterName];\n        });\n        const currentAvatarId = ref(getCurrentAvatarId(props.characterName));\n        const avatarHistoryIds = ref(getAvatarHistoryIds(props.characterName));\n        watch(() => props.characterName, () => {\n            currentAvatarId.value = getCurrentAvatarId(props.characterName);\n            avatarHistoryIds.value = getAvatarHistoryIds(props.characterName);\n        });\n        const currentAvatar = computed(() => {\n            return getAvatarUrl(props.characterName, currentAvatarId.value);\n        });\n        const avatarHistory = computed(() => {\n            return avatarHistoryIds.value.map(id => {\n                return getAvatarUrl(props.characterName, id);\n            });\n        });\n        // 处理图片加载失败\n        function handleImageError(event) {\n            const img = event.target;\n            img.style.display = 'none';\n        }\n        // 处理历史头像图片加载失败\n        function handleHistoryImageError(event) {\n            const img = event.target;\n            img.parentElement?.classList.add('error');\n        }\n        // 显示头像更换选项\n        function showAvatarOptions() {\n            // 如果对话框已经打开，直接返回\n            if (isAvatarOptionsDialogOpen || currentDialogElement)\n                return;\n            isAvatarOptionsDialogOpen = true;\n            // 使用自定义对话框替代 confirm\n            const dialog = document.createElement('div');\n            // 获取当前角色的头像库\n            const charAvatarLibrary = getCharacterAvatarLibrary(props.characterName);\n            dialog.innerHTML = `\n    <div style=\"\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.7);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n    \">\n      <div style=\"\n        background: var(--card-bg-color, #1e1e2e);\n        border: 1px solid var(--border-color, #45475a);\n        border-radius: 12px;\n        padding: 24px;\n        min-width: 300px;\n        max-width: 90%;\n        max-height: 90vh;\n        overflow-y: auto;\n        color: var(--text-color, #cdd6f4);\n      \">\n        <h3 style=\"margin: 0 0 16px 0; font-size: 18px;\">更换头像</h3>\n        <p style=\"margin: 0 0 20px 0; color: var(--subtext-color, #a6adc8);\">请选择头像：</p>\n        <div class=\"avatar-library-grid\" style=\"\n          display: grid;\n          grid-template-columns: repeat(3, 1fr);\n          gap: 12px;\n          margin-bottom: 20px;\n        \">\n          ${Object.entries(charAvatarLibrary)\n                .map(([id, url]) => `\n            <div style=\"\n              border: 2px solid ${currentAvatarId.value == parseInt(id) ? 'var(--blue)' : 'var(--border-color)'};\n              border-radius: 8px;\n              overflow: hidden;\n              cursor: pointer;\n              transition: all 0.2s;\n              height: 80px;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              background-color: var(--quote-bg-color);\n              position: relative;\n            \" data-avatar-id=\"${id}\">\n              ${url ? `<img src=\"${url}\" style=\"width: 100%; height: 100%; object-fit: cover;\" />` : '<i class=\"fas fa-user\" style=\"font-size: 24px; color: var(--subtext-color);\"></i>'}\n              ${parseInt(id) !== 0\n                ? `<button data-delete-avatar-id=\"${id}\" style=\"\n                position: absolute;\n                top: 4px;\n                right: 4px;\n                width: 24px;\n                height: 24px;\n                background: rgba(0,0,0,0.7);\n                color: var(--red);\n                border: none;\n                border-radius: 50%;\n                cursor: pointer;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                font-size: 12px;\n                opacity: 0;\n                transition: opacity 0.2s;\n              \" onmouseover=\"this.style.opacity='1'\" onmouseout=\"this.style.opacity='0'\">×</button>`\n                : ''}\n            </div>\n          `)\n                .join('')}\n        </div>\n        \n        <div style=\"border-top: 1px solid var(--border-color); padding-top: 16px; margin-top: 16px;\">\n          <h4 style=\"margin: 0 0 12px 0; font-size: 14px; color: var(--subtext-color);\">添加新头像</h4>\n          <button id=\"btn-add-avatar\" style=\"\n            width: 100%;\n            padding: 12px;\n            background: var(--blue);\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: bold;\n          \">添加头像</button>\n        </div>\n        \n        <button id=\"btn-cancel\" style=\"\n          width: 100%;\n          padding: 10px;\n          margin-top: 16px;\n          background: transparent;\n          color: var(--subtext-color, #a6adc8);\n          border: none;\n          cursor: pointer;\n        \">取消</button>\n      </div>\n    </div>\n  `;\n            document.body.appendChild(dialog);\n            currentDialogElement = dialog;\n            // 绑定头像选择事件\n            Object.entries(charAvatarLibrary).forEach(([id]) => {\n                const element = dialog.querySelector(`[data-avatar-id=\"${id}\"]`);\n                element?.addEventListener('click', () => {\n                    if (currentDialogElement === dialog) {\n                        document.body.removeChild(dialog);\n                        currentDialogElement = null;\n                    }\n                    isAvatarOptionsDialogOpen = false;\n                    updateAvatar(parseInt(id));\n                });\n            });\n            // 绑定删除头像按钮事件\n            Object.entries(charAvatarLibrary).forEach(([id]) => {\n                if (parseInt(id) !== 0) {\n                    const deleteButton = dialog.querySelector(`[data-delete-avatar-id=\"${id}\"]`);\n                    deleteButton?.addEventListener('click', async (e) => {\n                        e.stopPropagation();\n                        await deleteAvatar(parseInt(id));\n                    });\n                }\n            });\n            dialog.querySelector('#btn-cancel')?.addEventListener('click', () => {\n                if (currentDialogElement === dialog) {\n                    document.body.removeChild(dialog);\n                    currentDialogElement = null;\n                }\n                isAvatarOptionsDialogOpen = false;\n            });\n            // 绑定添加头像按钮事件\n            dialog.querySelector('#btn-add-avatar')?.addEventListener('click', () => {\n                if (currentDialogElement === dialog) {\n                    document.body.removeChild(dialog);\n                    currentDialogElement = null;\n                }\n                isAvatarOptionsDialogOpen = false;\n                showAddAvatarDialog();\n            });\n            // 点击背景关闭\n            dialog.firstElementChild?.addEventListener('click', e => {\n                if (e.target === dialog.firstElementChild) {\n                    if (currentDialogElement === dialog) {\n                        document.body.removeChild(dialog);\n                        currentDialogElement = null;\n                    }\n                    isAvatarOptionsDialogOpen = false;\n                }\n            });\n        }\n        async function updateAvatar(newAvatarId) {\n            await setCurrentAvatarId(props.characterName, newAvatarId);\n            currentAvatarId.value = getCurrentAvatarId(props.characterName);\n            avatarHistoryIds.value = getAvatarHistoryIds(props.characterName);\n            console.log('头像已更新:', props.characterName, newAvatarId);\n        }\n        // 显示添加头像对话框\n        function showAddAvatarDialog() {\n            const dialog = document.createElement('div');\n            dialog.innerHTML = `\n    <div style=\"\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.7);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n    \">\n      <div style=\"\n        background: var(--card-bg-color, #1e1e2e);\n        border: 1px solid var(--border-color, #45475a);\n        border-radius: 12px;\n        padding: 24px;\n        min-width: 300px;\n        max-width: 90%;\n        color: var(--text-color, #cdd6f4);\n      \">\n        <h3 style=\"margin: 0 0 16px 0; font-size: 18px;\">添加头像</h3>\n        <p style=\"margin: 0 0 20px 0; color: var(--subtext-color, #a6adc8);\">请选择添加方式：</p>\n        <div style=\"display: flex; flex-direction: column; gap: 12px; margin-bottom: 16px;\">\n          <button id=\"btn-use-url\" style=\"\n            padding: 14px;\n            background: var(--blue);\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 15px;\n            font-weight: bold;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 8px;\n          \">\n            <i class=\"fas fa-link\"></i>\n            使用链接\n          </button>\n          <button id=\"btn-use-file\" style=\"\n            padding: 14px;\n            background: var(--green);\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 15px;\n            font-weight: bold;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 8px;\n          \">\n            <i class=\"fas fa-folder-open\"></i>\n            选择本地文件\n          </button>\n        </div>\n        <button id=\"btn-cancel\" style=\"\n          width: 100%;\n          padding: 12px;\n          background: transparent;\n          color: var(--subtext-color, #a6adc8);\n          border: none;\n          border-radius: 8px;\n          cursor: pointer;\n          font-size: 14px;\n        \">取消</button>\n      </div>\n    </div>\n  `;\n            document.body.appendChild(dialog);\n            dialog.querySelector('#btn-use-url')?.addEventListener('click', () => {\n                document.body.removeChild(dialog);\n                currentDialogElement = null;\n                showUrlInputDialog();\n            });\n            dialog.querySelector('#btn-use-file')?.addEventListener('click', () => {\n                document.body.removeChild(dialog);\n                currentDialogElement = null;\n                showFileSelectorDialog();\n            });\n            dialog.querySelector('#btn-cancel')?.addEventListener('click', () => {\n                document.body.removeChild(dialog);\n                currentDialogElement = null;\n                // 头像选择对话框已被关闭，需要重新显示\n                isAvatarOptionsDialogOpen = false;\n                showAvatarOptions();\n            });\n            dialog.firstElementChild?.addEventListener('click', e => {\n                if (e.target === dialog.firstElementChild) {\n                    document.body.removeChild(dialog);\n                    currentDialogElement = null;\n                    // 头像选择对话框已被关闭，需要重新显示\n                    isAvatarOptionsDialogOpen = false;\n                    showAvatarOptions();\n                }\n            });\n        }\n        // 显示URL输入对话框\n        function showUrlInputDialog() {\n            const dialog = document.createElement('div');\n            dialog.innerHTML = `\n    <div style=\"\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.7);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n    \">\n      <div style=\"\n        background: var(--card-bg-color, #1e1e2e);\n        border: 1px solid var(--border-color, #45475a);\n        border-radius: 12px;\n        padding: 24px;\n        min-width: 300px;\n        max-width: 90%;\n        color: var(--text-color, #cdd6f4);\n      \">\n        <h3 style=\"margin: 0 0 16px 0; font-size: 18px;\">输入图片链接</h3>\n        <p style=\"margin: 0 0 20px 0; color: var(--subtext-color, #a6adc8);\">请输入图片的URL地址：</p>\n        <input type=\"text\" id=\"avatar-url-input\" placeholder=\"https://example.com/avatar.jpg\" style=\"\n          width: 100%;\n          padding: 12px;\n          background: var(--input-bg-color, #313244);\n          border: 1px solid var(--border-color, #45475a);\n          border-radius: 6px;\n          color: var(--text-color, #cdd6f4);\n          font-size: 14px;\n          margin-bottom: 16px;\n          box-sizing: border-box;\n        \" />\n        <div style=\"display: flex; gap: 12px;\">\n          <button id=\"btn-confirm\" style=\"\n            flex: 1;\n            padding: 12px;\n            background: var(--blue);\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: bold;\n          \">确认</button>\n          <button id=\"btn-cancel\" style=\"\n            flex: 1;\n            padding: 12px;\n            background: transparent;\n            color: var(--subtext-color, #a6adc8);\n            border: 1px solid var(--border-color, #45475a);\n            border-radius: 8px;\n            cursor: pointer;\n          \">取消</button>\n        </div>\n      </div>\n    </div>\n  `;\n            document.body.appendChild(dialog);\n            dialog.querySelector('#btn-confirm')?.addEventListener('click', () => {\n                const urlInput = dialog.querySelector('#avatar-url-input');\n                const url = urlInput.value.trim();\n                if (url) {\n                    document.body.removeChild(dialog);\n                    currentDialogElement = null;\n                    addAvatarByUrl(url);\n                }\n            });\n            dialog.querySelector('#btn-cancel')?.addEventListener('click', () => {\n                document.body.removeChild(dialog);\n                currentDialogElement = null;\n                // 头像选择对话框已被关闭，需要重新显示\n                isAvatarOptionsDialogOpen = false;\n                showAvatarOptions();\n            });\n            dialog.firstElementChild?.addEventListener('click', e => {\n                if (e.target === dialog.firstElementChild) {\n                    document.body.removeChild(dialog);\n                    currentDialogElement = null;\n                    // 头像选择对话框已被关闭，需要重新显示\n                    isAvatarOptionsDialogOpen = false;\n                    showAvatarOptions();\n                }\n            });\n        }\n        // 显示文件选择对话框\n        function showFileSelectorDialog() {\n            const input = document.createElement('input');\n            input.type = 'file';\n            input.accept = 'image/*';\n            input.style.display = 'none';\n            input.addEventListener('change', async (e) => {\n                const fileInput = e.target;\n                const file = fileInput.files?.[0];\n                if (file) {\n                    // 检查文件大小，限制为 2MB\n                    const maxSize = 2 * 1024 * 1024; // 2MB\n                    if (file.size > maxSize) {\n                        alert('图片文件过大，请选择小于 2MB 的图片');\n                        document.body.removeChild(input);\n                        currentDialogElement = null;\n                        return;\n                    }\n                    // 将文件转换为 Base64 存储，避免页面刷新后 URL 失效\n                    const reader = new FileReader();\n                    reader.onload = async (event) => {\n                        const base64Url = event.target?.result;\n                        if (base64Url) {\n                            currentDialogElement = null;\n                            await addAvatarByUrl(base64Url);\n                        }\n                    };\n                    reader.onerror = () => {\n                        alert('读取图片文件失败');\n                        document.body.removeChild(input);\n                        currentDialogElement = null;\n                        // 重新显示头像选择对话框\n                        isAvatarOptionsDialogOpen = false;\n                        showAvatarOptions();\n                    };\n                    reader.readAsDataURL(file);\n                }\n                else {\n                    // 用户取消选择\n                    document.body.removeChild(input);\n                    currentDialogElement = null;\n                }\n                document.body.removeChild(input);\n            });\n            document.body.appendChild(input);\n            input.click();\n        }\n        async function addAvatarByUrl(url) {\n            const newAvatarId = getNextAvatarId(props.characterName);\n            await addAvatar(props.characterName, newAvatarId, url);\n            console.log('已添加新头像:', props.characterName, newAvatarId, url);\n            await updateAvatar(newAvatarId);\n            isAvatarOptionsDialogOpen = false;\n            currentDialogElement = null;\n            showAvatarOptions();\n        }\n        async function deleteAvatar(avatarId) {\n            const charAvatarLibrary = getCharacterAvatarLibrary(props.characterName);\n            const avatarUrl = charAvatarLibrary[avatarId];\n            if (!avatarUrl)\n                return;\n            const dialog = document.createElement('div');\n            dialog.innerHTML = `\n    <div style=\"\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.7);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n    \">\n      <div style=\"\n        background: var(--card-bg-color, #1e1e2e);\n        border: 1px solid var(--border-color, #45475a);\n        border-radius: 12px;\n        padding: 24px;\n        min-width: 300px;\n        max-width: 90%;\n        color: var(--text-color, #cdd6f4);\n      \">\n        <h3 style=\"margin: 0 0 16px 0; font-size: 18px;\">确认删除</h3>\n        <p style=\"margin: 0 0 20px 0; color: var(--subtext-color, #a6adc8);\">确定要删除这张头像吗？此操作无法撤销。</p>\n        <div style=\"display: flex; gap: 12px;\">\n          <button id=\"btn-confirm\" style=\"\n            flex: 1;\n            padding: 12px;\n            background: var(--red, #f38ba8);\n            color: #1e1e2e;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: bold;\n          \">删除</button>\n          <button id=\"btn-cancel\" style=\"\n            flex: 1;\n            padding: 12px;\n            background: transparent;\n            color: var(--subtext-color, #a6adc8);\n            border: 1px solid var(--border-color, #45475a);\n            border-radius: 8px;\n            cursor: pointer;\n          \">取消</button>\n        </div>\n      </div>\n    </div>\n  `;\n            document.body.appendChild(dialog);\n            dialog.querySelector('#btn-confirm')?.addEventListener('click', async () => {\n                document.body.removeChild(dialog);\n                if (currentDialogElement) {\n                    document.body.removeChild(currentDialogElement);\n                    currentDialogElement = null;\n                }\n                isAvatarOptionsDialogOpen = false;\n                await deleteAvatarFromLibrary(props.characterName, avatarId);\n                if (currentAvatarId.value === avatarId) {\n                    await updateAvatar(0);\n                }\n                currentAvatarId.value = getCurrentAvatarId(props.characterName);\n                avatarHistoryIds.value = getAvatarHistoryIds(props.characterName);\n                console.log('已删除头像:', props.characterName, avatarId);\n                showAvatarOptions();\n            });\n            dialog.querySelector('#btn-cancel')?.addEventListener('click', () => {\n                document.body.removeChild(dialog);\n            });\n            dialog.firstElementChild?.addEventListener('click', e => {\n                if (e.target === dialog.firstElementChild) {\n                    document.body.removeChild(dialog);\n                }\n            });\n        }\n        async function selectHistoryAvatar(avatar) {\n            const charAvatarLibrary = getCharacterAvatarLibrary(props.characterName);\n            const avatarId = Object.entries(charAvatarLibrary).find(([_, url]) => url === avatar)?.[0];\n            if (avatarId && parseInt(avatarId) !== currentAvatarId.value) {\n                await updateAvatar(parseInt(avatarId));\n            }\n        }\n        async function deleteHistoryAvatar(_avatar, index) {\n            const avatarId = avatarHistoryIds.value[index];\n            if (avatarId === undefined)\n                return;\n            const dialog = document.createElement('div');\n            dialog.innerHTML = `\n    <div style=\"\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.7);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n    \">\n      <div style=\"\n        background: var(--card-bg-color, #1e1e2e);\n        border: 1px solid var(--border-color, #45475a);\n        border-radius: 12px;\n        padding: 24px;\n        min-width: 300px;\n        max-width: 90%;\n        color: var(--text-color, #cdd6f4);\n      \">\n        <h3 style=\"margin: 0 0 16px 0; font-size: 18px;\">确认删除</h3>\n        <p style=\"margin: 0 0 20px 0; color: var(--subtext-color, #a6adc8);\">确定要从历史记录中移除这张头像吗？</p>\n        <div style=\"display: flex; gap: 12px;\">\n          <button id=\"btn-confirm\" style=\"\n            flex: 1;\n            padding: 12px;\n            background: var(--red, #f38ba8);\n            color: #1e1e2e;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: 600;\n          \">删除</button>\n          <button id=\"btn-cancel\" style=\"\n            flex: 1;\n            padding: 12px;\n            background: var(--surface-color, #313244);\n            color: var(--text-color, #cdd6f4);\n            border: 1px solid var(--border-color, #45475a);\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: 600;\n          \">取消</button>\n        </div>\n      </div>\n    </div>\n  `;\n            document.body.appendChild(dialog);\n            dialog.querySelector('#btn-confirm')?.addEventListener('click', async () => {\n                await removeFromHistory(props.characterName, avatarId);\n                avatarHistoryIds.value = getAvatarHistoryIds(props.characterName);\n                document.body.removeChild(dialog);\n            });\n            dialog.querySelector('#btn-cancel')?.addEventListener('click', () => {\n                document.body.removeChild(dialog);\n            });\n            dialog.firstElementChild?.addEventListener('click', e => {\n                if (e.target === dialog.firstElementChild) {\n                    document.body.removeChild(dialog);\n                }\n            });\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (!characterData.value && !sceneData.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"span\", null, \"加载角色信息中...\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        _createCommentVNode(\" 角色头像区域 \"),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"div\", _hoisted_5, [\n                                (currentAvatar.value)\n                                    ? (_openBlock(), _createElementBlock(\"img\", {\n                                        key: 0,\n                                        src: currentAvatar.value,\n                                        alt: __props.characterName,\n                                        class: \"character-avatar-img\",\n                                        onError: handleImageError\n                                    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_6))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [...(_cache[1] || (_cache[1] = [\n                                            _createElementVNode(\"i\", { class: \"fas fa-user\" }, null, -1 /* CACHED */)\n                                        ]))]))\n                            ]),\n                            _createCommentVNode(\" 底部内容层 \"),\n                            _createElementVNode(\"div\", _hoisted_8, [\n                                _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"avatar-text-gradient\" }, null, -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_9, [\n                                    _createElementVNode(\"div\", _hoisted_10, _toDisplayString(__props.characterName), 1 /* TEXT */),\n                                    _createCommentVNode(\" 历史头像 \"),\n                                    (avatarHistory.value.length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                            _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"history-title\" }, \"历史头像\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_12, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(avatarHistory.value, (avatar, index) => {\n                                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                                        key: index,\n                                                        class: _normalizeClass([\"history-item\", { active: avatar === currentAvatar.value }]),\n                                                        onClick: ($event) => (selectHistoryAvatar(avatar))\n                                                    }, [\n                                                        _createElementVNode(\"img\", {\n                                                            src: avatar,\n                                                            alt: `历史头像 ${index + 1}`,\n                                                            onError: handleHistoryImageError\n                                                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_14),\n                                                        _createElementVNode(\"button\", {\n                                                            class: \"delete-avatar-btn\",\n                                                            onClick: _withModifiers(($event) => (deleteHistoryAvatar(avatar, index)), [\"stop\"]),\n                                                            title: \"删除历史头像\"\n                                                        }, [...(_cache[2] || (_cache[2] = [\n                                                                _createElementVNode(\"i\", { class: \"fas fa-times\" }, null, -1 /* CACHED */)\n                                                            ]))], 8 /* PROPS */, _hoisted_15)\n                                                    ], 10 /* CLASS, PROPS */, _hoisted_13));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ])\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: \"change-avatar-btn\",\n                                onClick: showAvatarOptions,\n                                title: \"更换头像\"\n                            }, [...(_cache[5] || (_cache[5] = [\n                                    _createElementVNode(\"i\", { class: \"fas fa-camera\" }, null, -1 /* CACHED */)\n                                ]))])\n                        ]),\n                        _createCommentVNode(\" 角色基本信息 \"),\n                        _createElementVNode(\"div\", _hoisted_16, [\n                            _createElementVNode(\"div\", _hoisted_17, [\n                                _createElementVNode(\"div\", _hoisted_18, [\n                                    _cache[6] || (_cache[6] = _createElementVNode(\"i\", { class: \"fas fa-heartbeat\" }, null, -1 /* CACHED */)),\n                                    _cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \"状态：\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", null, _toDisplayString(sceneData.value?.State || '未知'), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_19, [\n                                    _cache[8] || (_cache[8] = _createElementVNode(\"i\", { class: \"fas fa-running\" }, null, -1 /* CACHED */)),\n                                    _cache[9] || (_cache[9] = _createElementVNode(\"strong\", null, \"行动：\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", null, _toDisplayString(sceneData.value?.Action || '未知'), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_20, [\n                                    _cache[10] || (_cache[10] = _createElementVNode(\"i\", { class: \"fas fa-shield-alt\" }, null, -1 /* CACHED */)),\n                                    _cache[11] || (_cache[11] = _createElementVNode(\"strong\", null, \"变身：\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", {\n                                        class: _normalizeClass(sceneData.value?.isTransformed ? 'status-highlight-yes' : 'status-highlight-no')\n                                    }, _toDisplayString(sceneData.value?.isTransformed ? '是' : '否'), 3 /* TEXT, CLASS */)\n                                ]),\n                                _createCommentVNode(\" 角色属性 \"),\n                                (characterData.value)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, [\n                                        _createElementVNode(\"div\", _hoisted_22, [\n                                            _cache[12] || (_cache[12] = _createElementVNode(\"span\", {\n                                                class: \"stat-bar-title\",\n                                                \"data-tooltip\": \"影响技能效果与消耗\"\n                                            }, [\n                                                _createElementVNode(\"i\", {\n                                                    class: \"fas fa-bolt\",\n                                                    style: { \"color\": \"var(--green)\" }\n                                                }),\n                                                _createTextVNode(\"魔力 \")\n                                            ], -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", _hoisted_23, _toDisplayString(characterData.value.Magic || 0) + \"/\" + _toDisplayString(characterData.value.MagicMax || 100), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_24, [\n                                            _createElementVNode(\"div\", {\n                                                class: \"progress-bar-fill magic-bar\",\n                                                style: _normalizeStyle({\n                                                    width: `${Math.min(((characterData.value.Magic || 0) / (characterData.value.MagicMax || 100)) * 100, 100)}%`,\n                                                })\n                                            }, null, 4 /* STYLE */)\n                                        ])\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true),\n                                (characterData.value)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_25, [\n                                        _createElementVNode(\"div\", _hoisted_26, [\n                                            _cache[13] || (_cache[13] = _createElementVNode(\"span\", {\n                                                class: \"stat-bar-title\",\n                                                \"data-tooltip\": \"影响角色间的互动与情感\"\n                                            }, [\n                                                _createElementVNode(\"i\", {\n                                                    class: \"fas fa-heart\",\n                                                    style: { \"color\": \"var(--pink)\" }\n                                                }),\n                                                _createTextVNode(\"好感度 \")\n                                            ], -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", _hoisted_27, _toDisplayString(characterData.value.Favor || 0) + \"%\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_28, [\n                                            _createElementVNode(\"div\", {\n                                                class: _normalizeClass([\"progress-bar-fill\", (characterData.value.Favor || 0) >= 0 ? 'favor-bar-positive' : 'favor-bar-negative']),\n                                                style: _normalizeStyle({ width: `${Math.abs(characterData.value.Favor || 0)}%` })\n                                            }, null, 6 /* CLASS, STYLE */)\n                                        ])\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true),\n                                (characterData.value)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_29, [\n                                        _createElementVNode(\"div\", _hoisted_30, [\n                                            _cache[14] || (_cache[14] = _createElementVNode(\"span\", {\n                                                class: \"stat-bar-title\",\n                                                \"data-tooltip\": \"影响心智与能力，过高可能导致失控\"\n                                            }, [\n                                                _createElementVNode(\"i\", {\n                                                    class: \"fas fa-skull-crossbones\",\n                                                    style: { \"color\": \"var(--purple)\" }\n                                                }),\n                                                _createTextVNode(\"堕落值 \")\n                                            ], -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", _hoisted_31, _toDisplayString(characterData.value.Corruption || 0) + \"%\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_32, [\n                                            _createElementVNode(\"div\", {\n                                                class: \"progress-bar-fill corruption-bar\",\n                                                style: _normalizeStyle({ width: `${characterData.value.Corruption || 0}%` })\n                                            }, null, 4 /* STYLE */)\n                                        ])\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true),\n                                (sceneData.value)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_33, [\n                                        _createElementVNode(\"div\", _hoisted_34, [\n                                            _cache[15] || (_cache[15] = _createElementVNode(\"span\", {\n                                                class: \"stat-bar-title\",\n                                                \"data-tooltip\": \"影响角色的行为与理智\"\n                                            }, [\n                                                _createElementVNode(\"i\", {\n                                                    class: \"fas fa-fire\",\n                                                    style: { \"color\": \"var(--red)\" }\n                                                }),\n                                                _createTextVNode(\"情欲值 \")\n                                            ], -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", _hoisted_35, _toDisplayString(sceneData.value.Lust || 0) + \"%\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_36, [\n                                            _createElementVNode(\"div\", {\n                                                class: \"progress-bar-fill lust-bar\",\n                                                style: _normalizeStyle({ width: `${sceneData.value.Lust || 0}%` })\n                                            }, null, 4 /* STYLE */)\n                                        ])\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true),\n                                _createCommentVNode(\" 角色心理活动 \"),\n                                (sceneData.value?.Thought)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_37, [\n                                        _cache[16] || (_cache[16] = _createElementVNode(\"div\", { class: \"thought-title\" }, [\n                                            _createElementVNode(\"i\", { class: \"fas fa-comment-dots\" }),\n                                            _createTextVNode(\"心理活动\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"p\", null, _toDisplayString(sceneData.value.Thought), 1 /* TEXT */)\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ]),\n                        _createCommentVNode(\" 角色介绍 \"),\n                        (characterData.value?.Description && characterData.value.Description.length > 0)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_38, [\n                                _cache[17] || (_cache[17] = _createElementVNode(\"div\", { class: \"description-title\" }, [\n                                    _createElementVNode(\"i\", { class: \"fas fa-info-circle\" }),\n                                    _createTextVNode(\"角色介绍\")\n                                ], -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_39, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(characterData.value.Description, (item, index) => {\n                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                            key: index,\n                                            class: \"description-item\"\n                                        }, _toDisplayString(item), 1 /* TEXT */));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ])\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterDetailPanel.vue?vue&type=style&index=0&id=0538ae1d&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0538ae1d\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"characters-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"characters-list\"\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"char-name-left\" };\nconst _hoisted_6 = [\"src\"];\nconst _hoisted_7 = {\n    key: 1,\n    class: \"char-avatar-placeholder\"\n};\nconst _hoisted_8 = { class: \"char-name-text\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"character-detail\"\n};\nconst _hoisted_10 = { class: \"char-details\" };\nconst _hoisted_11 = { class: \"detail-item\" };\nconst _hoisted_12 = { class: \"detail-item\" };\nconst _hoisted_13 = { class: \"detail-item\" };\nconst _hoisted_14 = {\n    key: 0,\n    class: \"stat-bar-container\"\n};\nconst _hoisted_15 = { class: \"stat-bar-label\" };\nconst _hoisted_16 = { class: \"stat-bar-value\" };\nconst _hoisted_17 = { class: \"progress-bar\" };\nconst _hoisted_18 = {\n    key: 1,\n    class: \"stat-bar-container\"\n};\nconst _hoisted_19 = { class: \"stat-bar-label\" };\nconst _hoisted_20 = { class: \"stat-bar-value\" };\nconst _hoisted_21 = { class: \"progress-bar\" };\nconst _hoisted_22 = {\n    key: 2,\n    class: \"stat-bar-container\"\n};\nconst _hoisted_23 = { class: \"stat-bar-label\" };\nconst _hoisted_24 = { class: \"stat-bar-value\" };\nconst _hoisted_25 = { class: \"progress-bar\" };\nconst _hoisted_26 = { class: \"stat-bar-container\" };\nconst _hoisted_27 = { class: \"stat-bar-label\" };\nconst _hoisted_28 = { class: \"stat-bar-value\" };\nconst _hoisted_29 = { class: \"progress-bar\" };\nconst _hoisted_30 = {\n    key: 3,\n    class: \"thought-block\"\n};\nimport { computed, ref } from 'vue';\nimport { getAvatarUrl as getAvatarUrlFromLibrary, getCurrentAvatarId } from '../avatarLibrary';\nimport { useDataStore } from '../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharactersPanel',\n    setup(__props) {\n        const dataStore = useDataStore();\n        const sceneCharacters = computed(() => dataStore.data.在场角色 || {});\n        const characterList = computed(() => dataStore.data.角色列表 || {});\n        const expandedCharacters = ref({});\n        function toggleCharacterDetail(charName) {\n            expandedCharacters.value[charName] = !expandedCharacters.value[charName];\n        }\n        function getCharacterAvatarUrl(charName) {\n            const avatarId = getCurrentAvatarId(charName);\n            return getAvatarUrlFromLibrary(charName, avatarId);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[14] || (_cache[14] = _createElementVNode(\"h3\", { class: \"panel-title\" }, \"在场角色\", -1 /* CACHED */)),\n                (Object.keys(sceneCharacters.value).length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"当前没有在场角色\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(sceneCharacters.value, (char, charName) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: charName,\n                                class: \"char-card\"\n                            }, [\n                                _createElementVNode(\"div\", {\n                                    class: \"char-name\",\n                                    onClick: ($event) => (toggleCharacterDetail(charName))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_5, [\n                                        (getCharacterAvatarUrl(charName))\n                                            ? (_openBlock(), _createElementBlock(\"img\", {\n                                                key: 0,\n                                                src: getCharacterAvatarUrl(charName),\n                                                class: \"char-avatar\",\n                                                alt: \"头像\"\n                                            }, null, 8 /* PROPS */, _hoisted_6))\n                                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [...(_cache[1] || (_cache[1] = [\n                                                    _createElementVNode(\"i\", { class: \"fas fa-user\" }, null, -1 /* CACHED */)\n                                                ]))])),\n                                        _createElementVNode(\"span\", _hoisted_8, _toDisplayString(charName), 1 /* TEXT */)\n                                    ]),\n                                    (_openBlock(), _createElementBlock(\"svg\", {\n                                        class: _normalizeClass([\"collapse-icon\", { rotated: expandedCharacters.value[charName] }]),\n                                        viewBox: \"0 0 320 512\",\n                                        fill: \"currentColor\",\n                                        xmlns: \"http://www.w3.org/2000/svg\"\n                                    }, [...(_cache[2] || (_cache[2] = [\n                                            _createElementVNode(\"path\", { d: \"M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4 9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z\" }, null, -1 /* CACHED */)\n                                        ]))], 2 /* CLASS */))\n                                ], 8 /* PROPS */, _hoisted_4),\n                                _createCommentVNode(\" 展开的角色详情 \"),\n                                (expandedCharacters.value[charName])\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                        _createElementVNode(\"div\", _hoisted_10, [\n                                            _createElementVNode(\"div\", _hoisted_11, [\n                                                _cache[3] || (_cache[3] = _createElementVNode(\"i\", { class: \"fas fa-heartbeat\" }, null, -1 /* CACHED */)),\n                                                _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"状态：\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", null, _toDisplayString(char.State || '未知'), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_12, [\n                                                _cache[5] || (_cache[5] = _createElementVNode(\"i\", { class: \"fas fa-running\" }, null, -1 /* CACHED */)),\n                                                _cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \"行动：\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", null, _toDisplayString(char.Action || '未知'), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_13, [\n                                                _cache[7] || (_cache[7] = _createElementVNode(\"i\", { class: \"fas fa-shield-alt\" }, null, -1 /* CACHED */)),\n                                                _cache[8] || (_cache[8] = _createElementVNode(\"strong\", null, \"变身：\", -1 /* CACHED */)),\n                                                _createElementVNode(\"span\", {\n                                                    class: _normalizeClass(char.isTransformed ? 'status-highlight-yes' : 'status-highlight-no')\n                                                }, _toDisplayString(char.isTransformed ? '是' : '否'), 3 /* TEXT, CLASS */)\n                                            ]),\n                                            _createCommentVNode(\" 角色属性 \"),\n                                            (characterList.value[charName])\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                                                    _createElementVNode(\"div\", _hoisted_15, [\n                                                        _cache[9] || (_cache[9] = _createElementVNode(\"span\", { class: \"stat-bar-title\" }, [\n                                                            _createElementVNode(\"i\", {\n                                                                class: \"fas fa-bolt\",\n                                                                style: { \"color\": \"var(--green)\" }\n                                                            }),\n                                                            _createTextVNode(\"魔力 \")\n                                                        ], -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_16, _toDisplayString(characterList.value[charName].Magic || 0) + \"/\" + _toDisplayString(characterList.value[charName].MagicMax || 100), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_17, [\n                                                        _createElementVNode(\"div\", {\n                                                            class: \"progress-bar-fill magic-bar\",\n                                                            style: _normalizeStyle({\n                                                                width: `${Math.min(((characterList.value[charName].Magic || 0) / (characterList.value[charName].MagicMax || 100)) * 100, 100)}%`,\n                                                            })\n                                                        }, null, 4 /* STYLE */)\n                                                    ])\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (characterList.value[charName])\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [\n                                                    _createElementVNode(\"div\", _hoisted_19, [\n                                                        _cache[10] || (_cache[10] = _createElementVNode(\"span\", { class: \"stat-bar-title\" }, [\n                                                            _createElementVNode(\"i\", {\n                                                                class: \"fas fa-heart\",\n                                                                style: { \"color\": \"var(--pink)\" }\n                                                            }),\n                                                            _createTextVNode(\"好感度 \")\n                                                        ], -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_20, _toDisplayString(characterList.value[charName].Favor || 0) + \"%\", 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_21, [\n                                                        _createElementVNode(\"div\", {\n                                                            class: _normalizeClass([\"progress-bar-fill\", (characterList.value[charName].Favor || 0) >= 0 ? 'favor-bar-positive' : 'favor-bar-negative']),\n                                                            style: _normalizeStyle({ width: `${Math.abs(characterList.value[charName].Favor || 0)}%` })\n                                                        }, null, 6 /* CLASS, STYLE */)\n                                                    ])\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (characterList.value[charName])\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_22, [\n                                                    _createElementVNode(\"div\", _hoisted_23, [\n                                                        _cache[11] || (_cache[11] = _createElementVNode(\"span\", { class: \"stat-bar-title\" }, [\n                                                            _createElementVNode(\"i\", {\n                                                                class: \"fas fa-skull-crossbones\",\n                                                                style: { \"color\": \"var(--purple)\" }\n                                                            }),\n                                                            _createTextVNode(\"堕落值 \")\n                                                        ], -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_24, _toDisplayString(characterList.value[charName].Corruption || 0) + \"%\", 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_25, [\n                                                        _createElementVNode(\"div\", {\n                                                            class: \"progress-bar-fill corruption-bar\",\n                                                            style: _normalizeStyle({ width: `${characterList.value[charName].Corruption || 0}%` })\n                                                        }, null, 4 /* STYLE */)\n                                                    ])\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            _createElementVNode(\"div\", _hoisted_26, [\n                                                _createElementVNode(\"div\", _hoisted_27, [\n                                                    _cache[12] || (_cache[12] = _createElementVNode(\"span\", { class: \"stat-bar-title\" }, [\n                                                        _createElementVNode(\"i\", {\n                                                            class: \"fas fa-fire\",\n                                                            style: { \"color\": \"var(--red)\" }\n                                                        }),\n                                                        _createTextVNode(\"情欲值 \")\n                                                    ], -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_28, _toDisplayString(char.Lust || 0) + \"%\", 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_29, [\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"progress-bar-fill lust-bar\",\n                                                        style: _normalizeStyle({ width: `${char.Lust || 0}%` })\n                                                    }, null, 4 /* STYLE */)\n                                                ])\n                                            ]),\n                                            _createCommentVNode(\" 角色心理活动 \"),\n                                            (char.Thought)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_30, [\n                                                    _cache[13] || (_cache[13] = _createElementVNode(\"div\", { class: \"thought-title\" }, [\n                                                        _createElementVNode(\"i\", { class: \"fas fa-comment-dots\" }),\n                                                        _createTextVNode(\"心理活动\")\n                                                    ], -1 /* CACHED */)),\n                                                    _createElementVNode(\"p\", null, _toDisplayString(char.Thought), 1 /* TEXT */)\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ])\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharactersPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharactersPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharactersPanel.vue?vue&type=style&index=0&id=5675bb57&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5675bb57\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = { class: \"skills-panel\" };\nconst _hoisted_2 = { class: \"skill-points-display\" };\nconst _hoisted_3 = { class: \"points-card\" };\nconst _hoisted_4 = { class: \"points-info\" };\nconst _hoisted_5 = { class: \"points-value\" };\nconst _hoisted_6 = { class: \"magic-max-upgrade\" };\nconst _hoisted_7 = { class: \"upgrade-header\" };\nconst _hoisted_8 = { class: \"current-magic-max\" };\nconst _hoisted_9 = { class: \"upgrade-controls\" };\nconst _hoisted_10 = { class: \"input-group\" };\nconst _hoisted_11 = [\"max\"];\nconst _hoisted_12 = [\"disabled\"];\nconst _hoisted_13 = { class: \"upgrade-info\" };\nconst _hoisted_14 = { class: \"upgrade-cost\" };\nconst _hoisted_15 = { class: \"upgrade-result\" };\nconst _hoisted_16 = {\n    key: 0,\n    class: \"empty-skills\"\n};\nconst _hoisted_17 = {\n    key: 1,\n    class: \"skills-list\"\n};\nconst _hoisted_18 = [\"data-skill\"];\nconst _hoisted_19 = { class: \"skill-header\" };\nconst _hoisted_20 = { class: \"skill-title\" };\nconst _hoisted_21 = {\n    key: 0,\n    class: \"learned-badge\"\n};\nconst _hoisted_22 = { class: \"skill-name\" };\nconst _hoisted_23 = { class: \"skill-cost-badge\" };\nconst _hoisted_24 = { class: \"skill-description\" };\nconst _hoisted_25 = [\"disabled\", \"onClick\"];\nconst _hoisted_26 = {\n    key: 1,\n    class: \"learned-status\"\n};\nimport { computed, ref } from 'vue';\nimport { useDataStore } from '../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SkillsPanel',\n    setup(__props) {\n        const dataStore = useDataStore();\n        const upgradeAmount = ref(1);\n        const userData = computed(() => dataStore.data.user || {\n            SkillPoint: 0,\n            Magic: 0,\n            MagicMax: 100,\n            Morality: 0,\n            SkillTree: {},\n        });\n        const skillTree = computed(() => userData.value.SkillTree || {});\n        const canUpgrade = computed(() => {\n            return upgradeAmount.value > 0 && upgradeAmount.value <= userData.value.SkillPoint;\n        });\n        function canLearn(skill) {\n            const skillPoints = userData.value.SkillPoint || 0;\n            const skillCost = skill?.消耗 || 0;\n            return !skill?.已学习 && skillPoints >= skillCost;\n        }\n        function learnSkill(skillName, cost) {\n            const currentSkillPoints = userData.value.SkillPoint || 0;\n            const currentSkills = userData.value.SkillTree || {};\n            console.log('学习技能开始:', { skillName, cost, currentSkillPoints });\n            if (currentSkillPoints >= cost && !currentSkills[skillName]?.已学习) {\n                console.log('条件满足，准备学习技能');\n                const updatedSkills = {\n                    ...currentSkills,\n                    [skillName]: {\n                        ...currentSkills[skillName],\n                        已学习: true,\n                    },\n                };\n                const newSkillPoints = currentSkillPoints - cost;\n                console.log('新技能点:', newSkillPoints);\n                const newUserState = {\n                    ...userData.value,\n                    SkillPoint: newSkillPoints,\n                    SkillTree: updatedSkills,\n                };\n                dataStore.data.user = newUserState;\n                console.log('dataStore.data已更新:', dataStore.data.user);\n                const skillCard = document.querySelector(`[data-skill=\"${skillName}\"]`);\n                if (skillCard) {\n                    skillCard.classList.add('skill-learned-animation');\n                    setTimeout(() => {\n                        skillCard.classList.remove('skill-learned-animation');\n                    }, 1000);\n                }\n                console.log('学习技能完成');\n            }\n            else {\n                console.log('条件不满足:', {\n                    技能点足够: currentSkillPoints >= cost,\n                    技能未学习: !currentSkills[skillName]?.已学习,\n                });\n            }\n        }\n        function upgradeMagicMax() {\n            const currentSkillPoints = userData.value.SkillPoint || 0;\n            const currentMagicMax = userData.value.MagicMax || 100;\n            const currentMagic = userData.value.Magic || 0;\n            const amount = upgradeAmount.value || 0;\n            if (amount > 0 && amount <= currentSkillPoints) {\n                const newUserState = {\n                    ...userData.value,\n                    SkillPoint: currentSkillPoints - amount,\n                    MagicMax: currentMagicMax + amount,\n                    Magic: currentMagic + amount, // 同步提升魔力值\n                };\n                dataStore.data.user = newUserState;\n                upgradeAmount.value = 1;\n                console.log('魔力值上限已增加:', {\n                    原上限: currentMagicMax,\n                    增加点数: amount,\n                    新上限: currentMagicMax + amount,\n                    原魔力值: currentMagic,\n                    新魔力值: currentMagic + amount,\n                    剩余侵蚀点: currentSkillPoints - amount,\n                });\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[7] || (_cache[7] = _createElementVNode(\"h3\", { class: \"panel-title\" }, \"学习技能\", -1 /* CACHED */)),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"points-icon\" }, \"⭐\", -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(userData.value.SkillPoint), 1 /* TEXT */),\n                            _cache[1] || (_cache[1] = _createElementVNode(\"span\", { class: \"points-label\" }, \"可用侵蚀点\", -1 /* CACHED */))\n                        ])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        _cache[3] || (_cache[3] = _createElementVNode(\"span\", { class: \"upgrade-title\" }, \"💎 增加魔力值上限\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", _hoisted_8, \"当前上限: \" + _toDisplayString(userData.value.MagicMax), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        _createElementVNode(\"div\", _hoisted_10, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"label\", { class: \"input-label\" }, \"增加点数:\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((upgradeAmount).value = $event)),\n                                min: \"1\",\n                                max: userData.value.SkillPoint,\n                                class: \"upgrade-input\",\n                                placeholder: \"输入点数\"\n                            }, null, 8 /* PROPS */, _hoisted_11), [\n                                [\n                                    _vModelText,\n                                    upgradeAmount.value,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"button\", {\n                            class: _normalizeClass([\"upgrade-button\", { disabled: !canUpgrade.value }]),\n                            disabled: !canUpgrade.value,\n                            onClick: upgradeMagicMax\n                        }, \" 确认增加 \", 10 /* CLASS, PROPS */, _hoisted_12)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_13, [\n                        _createElementVNode(\"span\", _hoisted_14, \"消耗: \" + _toDisplayString(upgradeAmount.value) + \" 侵蚀点\", 1 /* TEXT */),\n                        _createElementVNode(\"span\", _hoisted_15, \"增加后上限: \" + _toDisplayString(userData.value.MagicMax + upgradeAmount.value), 1 /* TEXT */)\n                    ])\n                ]),\n                (Object.keys(skillTree.value).length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_16, [...(_cache[5] || (_cache[5] = [\n                            _createElementVNode(\"p\", null, \"暂无可学习的技能\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_17, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skillTree.value, (skill, skillName) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: skillName,\n                                class: _normalizeClass([\"skill-card\", { learned: skill.已学习, disabled: !canLearn(skill) }]),\n                                \"data-skill\": skillName\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_19, [\n                                    _createElementVNode(\"div\", _hoisted_20, [\n                                        (skill.已学习)\n                                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_21, \"✓\"))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"span\", _hoisted_22, _toDisplayString(skillName), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_23, \"消耗: \" + _toDisplayString(skill.消耗) + \" 点\", 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"p\", _hoisted_24, _toDisplayString(skill.描述), 1 /* TEXT */),\n                                (!skill.已学习)\n                                    ? (_openBlock(), _createElementBlock(\"button\", {\n                                        key: 0,\n                                        class: _normalizeClass([\"learn-button\", { disabled: !canLearn(skill) }]),\n                                        disabled: !canLearn(skill),\n                                        onClick: ($event) => (learnSkill(skillName, skill.消耗 || 0))\n                                    }, _toDisplayString(canLearn(skill) ? '学习技能' : '点数不足'), 11 /* TEXT, CLASS, PROPS */, _hoisted_25))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_26, [...(_cache[6] || (_cache[6] = [\n                                            _createElementVNode(\"span\", { class: \"learned-text\" }, \"已学习\", -1 /* CACHED */)\n                                        ]))]))\n                            ], 10 /* CLASS, PROPS */, _hoisted_18));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SkillsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SkillsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SkillsPanel.vue?vue&type=style&index=0&id=b5026c5c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b5026c5c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"story-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"story-list\"\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"story-header\" };\nconst _hoisted_6 = { class: \"story-name\" };\nconst _hoisted_7 = { class: \"story-header-right\" };\nconst _hoisted_8 = { class: \"story-preview\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"endings-preview\"\n};\nconst _hoisted_10 = { class: \"endings-count\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"completed-endings-count\"\n};\nconst _hoisted_12 = {\n    key: 1,\n    class: \"no-endings-preview\"\n};\nimport { computed } from 'vue';\nimport { useDataStore } from '../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'StoryPanel',\n    setup(__props) {\n        const dataStore = useDataStore();\n        const storyLines = computed(() => dataStore.data.个人线 || {});\n        // 导航到个人线详情页面\n        function navigateToStoryDetail(storyName) {\n            // 使用事件总线导航\n            const event = new CustomEvent('navigate', {\n                detail: { page: 'story-detail', storyName },\n            });\n            window.dispatchEvent(event);\n        }\n        // 检查个人线是否有已完成的结局\n        function hasCompletedEnding(story) {\n            if (!story || !story.结局) {\n                return false;\n            }\n            return Object.values(story.结局).some((ending) => {\n                if (!ending || !ending.达成条件) {\n                    return false;\n                }\n                return Object.values(ending.达成条件).every(condition => condition === true);\n            });\n        }\n        // 获取个人线已完成结局数量\n        function getCompletedEndingsCount(story) {\n            if (!story || !story.结局) {\n                return 0;\n            }\n            return Object.values(story.结局).filter((ending) => {\n                if (!ending || !ending.达成条件) {\n                    return false;\n                }\n                return Object.values(ending.达成条件).every(condition => condition === true);\n            }).length;\n        }\n        // 获取个人线显示状态\n        function getStoryDisplayStatus(story) {\n            if (!story) {\n                return '未知';\n            }\n            // 检查是否有已完成的结局\n            const completedEndings = Object.entries(story.结局 || {}).filter(([_, ending]) => {\n                if (!ending || !ending.达成条件) {\n                    return false;\n                }\n                return Object.values(ending.达成条件).every(condition => condition === true);\n            });\n            if (completedEndings.length > 0) {\n                // 返回所有已完成结局的名称\n                const endingNames = completedEndings.map(([name]) => name).join('、');\n                return `已完成: ${endingNames}`;\n            }\n            // 否则返回原始状态\n            return story.状态 || '未开始';\n        }\n        // 获取个人线状态样式类\n        function getStoryStatusClass(story) {\n            if (hasCompletedEnding(story)) {\n                return 'status-ending-completed';\n            }\n            return getStatusClass(story.状态 || '未开始');\n        }\n        function getStatusClass(status) {\n            switch (status) {\n                case '未开始':\n                    return 'status-not-started';\n                case '进行中':\n                    return 'status-in-progress';\n                case '已完成':\n                    return 'status-completed';\n                default:\n                    return 'status-unknown';\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[3] || (_cache[3] = _createElementVNode(\"h3\", { class: \"panel-title\" }, \"个人线\", -1 /* CACHED */)),\n                (Object.keys(storyLines.value).length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"暂无个人线\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(storyLines.value, (story, storyName) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: storyName,\n                                class: _normalizeClass([\"story-card\", {\n                                        completed: story.状态 === '已完成',\n                                        'in-progress': story.状态 === '进行中',\n                                        'ending-completed': hasCompletedEnding(story)\n                                    }]),\n                                onClick: ($event) => (navigateToStoryDetail(storyName))\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_5, [\n                                    _createElementVNode(\"span\", _hoisted_6, _toDisplayString(storyName), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_7, [\n                                        _createElementVNode(\"span\", {\n                                            class: _normalizeClass([\"story-status\", getStoryStatusClass(story)])\n                                        }, _toDisplayString(getStoryDisplayStatus(story)), 3 /* TEXT, CLASS */),\n                                        _cache[1] || (_cache[1] = _createElementVNode(\"i\", { class: \"fas fa-arrow-right\" }, null, -1 /* CACHED */))\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_8, [\n                                    (Object.keys(story.结局).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                            _createElementVNode(\"span\", _hoisted_10, _toDisplayString(Object.keys(story.结局).length) + \" 个结局\", 1 /* TEXT */),\n                                            (getCompletedEndingsCount(story) > 0)\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_11, \" (\" + _toDisplayString(getCompletedEndingsCount(story)) + \" 个已完成) \", 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [...(_cache[2] || (_cache[2] = [\n                                                _createElementVNode(\"span\", null, \"暂未达成任何结局\", -1 /* CACHED */)\n                                            ]))]))\n                                ])\n                            ], 10 /* CLASS, PROPS */, _hoisted_4));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./StoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./StoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./StoryPanel.vue?vue&type=style&index=0&id=bb48bf38&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-bb48bf38\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, unref as _unref, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createVNode as _createVNode, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, resolveComponent as _resolveComponent, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = {\n    id: \"status-container\",\n    class: \"status-panel-container\"\n};\nconst _hoisted_2 = {\n    key: 0,\n    id: \"main-menu-page\"\n};\nconst _hoisted_3 = { class: \"scene-info\" };\nconst _hoisted_4 = { class: \"info-line\" };\nconst _hoisted_5 = { class: \"info-line\" };\nconst _hoisted_6 = { class: \"info-line\" };\nconst _hoisted_7 = { class: \"menu-buttons\" };\nconst _hoisted_8 = {\n    key: 1,\n    id: \"archive-page\",\n    class: \"page-view\"\n};\nconst _hoisted_9 = {\n    key: 2,\n    id: \"terminal-page\",\n    class: \"page-view\"\n};\nconst _hoisted_10 = { class: \"user-stats-section\" };\nconst _hoisted_11 = { class: \"stats-grid\" };\nconst _hoisted_12 = { class: \"stat-card\" };\nconst _hoisted_13 = { class: \"stat-info\" };\nconst _hoisted_14 = { class: \"stat-value\" };\nconst _hoisted_15 = { class: \"stat-card\" };\nconst _hoisted_16 = { class: \"stat-info\" };\nconst _hoisted_17 = { class: \"stat-value\" };\nconst _hoisted_18 = { class: \"stat-card\" };\nconst _hoisted_19 = { class: \"stat-info\" };\nconst _hoisted_20 = { class: \"skills-section\" };\nconst _hoisted_21 = { class: \"skill-cards\" };\nconst _hoisted_22 = { class: \"skill-card-text\" };\nconst _hoisted_23 = { class: \"skill-card-count\" };\nconst _hoisted_24 = {\n    key: 3,\n    id: \"skill-list-page\",\n    class: \"page-view\"\n};\nconst _hoisted_25 = { class: \"block-title\" };\nconst _hoisted_26 = {\n    width: \"24\",\n    height: \"24\",\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    \"stroke-width\": \"2\",\n    \"stroke-linecap\": \"round\",\n    \"stroke-linejoin\": \"round\",\n    style: { \"margin-right\": \"8px\" }\n};\nconst _hoisted_27 = { class: \"skill-list-content\" };\nconst _hoisted_28 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_29 = {\n    key: 1,\n    class: \"learned-skills-list\"\n};\nconst _hoisted_30 = { class: \"skill-item-header\" };\nconst _hoisted_31 = { class: \"skill-name\" };\nconst _hoisted_32 = { class: \"skill-description\" };\nconst _hoisted_33 = {\n    key: 4,\n    id: \"learn-skills-page\",\n    class: \"page-view\"\n};\nconst _hoisted_34 = { class: \"learn-skills-content\" };\nconst _hoisted_35 = {\n    key: 5,\n    id: \"characters-page\",\n    class: \"page-view\"\n};\nconst _hoisted_36 = {\n    key: 6,\n    id: \"user-page\",\n    class: \"page-view\"\n};\nconst _hoisted_37 = {\n    key: 7,\n    id: \"story-page\",\n    class: \"page-view\"\n};\nconst _hoisted_38 = {\n    key: 8,\n    id: \"story-detail-page\",\n    class: \"page-view\"\n};\nconst _hoisted_39 = { class: \"block-title\" };\nconst _hoisted_40 = { class: \"story-detail-content\" };\nconst _hoisted_41 = {\n    key: 0,\n    class: \"loading\"\n};\nconst _hoisted_42 = {\n    key: 1,\n    class: \"story-detail-card\"\n};\nconst _hoisted_43 = { class: \"story-status\" };\nconst _hoisted_44 = {\n    key: 0,\n    class: \"endings-section\"\n};\nconst _hoisted_45 = { class: \"endings-list\" };\nconst _hoisted_46 = { class: \"ending-header\" };\nconst _hoisted_47 = {\n    key: 0,\n    class: \"ending-completed-badge\"\n};\nconst _hoisted_48 = {\n    key: 0,\n    class: \"ending-description\"\n};\nconst _hoisted_49 = { class: \"description-content\" };\nconst _hoisted_50 = {\n    key: 1,\n    class: \"ending-conditions\"\n};\nconst _hoisted_51 = { class: \"conditions-list\" };\nconst _hoisted_52 = [\"onClick\"];\nconst _hoisted_53 = { class: \"condition-name\" };\nconst _hoisted_54 = { class: \"condition-status\" };\nconst _hoisted_55 = {\n    key: 1,\n    class: \"no-endings\"\n};\nconst _hoisted_56 = {\n    key: 9,\n    id: \"character-detail-page\",\n    class: \"page-view\"\n};\nconst _hoisted_57 = { class: \"block-title\" };\nimport { computed, onMounted, onUnmounted, ref } from 'vue';\nimport CharacterArchivePanel from './components/CharacterArchivePanel.vue';\nimport CharacterDetailPanel from './components/CharacterDetailPanel.vue';\nimport CharactersPanel from './components/CharactersPanel.vue';\nimport SkillsPanel from './components/SkillsPanel.vue';\nimport StoryPanel from './components/StoryPanel.vue';\nimport { useDataStore } from './store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'App',\n    setup(__props) {\n        const dataStore = useDataStore();\n        const currentPage = ref('main');\n        const selectedCharacter = ref('');\n        const selectedStory = ref('');\n        const previousPage = ref('main');\n        // 导航函数\n        function navigateTo(page, param) {\n            if (page === 'character-detail') {\n                previousPage.value = currentPage.value;\n            }\n            currentPage.value = page;\n            if (param) {\n                if (page === 'character-detail') {\n                    selectedCharacter.value = param;\n                }\n                else if (page === 'story-detail') {\n                    selectedStory.value = param;\n                }\n            }\n        }\n        // 获取个人线数据\n        const storyData = computed(() => {\n            return dataStore.data.个人线?.[selectedStory.value];\n        });\n        // 检查结局是否完成\n        function isEndingCompleted(ending) {\n            if (!ending || !ending.达成条件) {\n                return false;\n            }\n            const conditions = ending.达成条件;\n            return Object.values(conditions).every(condition => condition === true);\n        }\n        // 切换结局条件状态\n        function toggleCondition(endingName, conditionName, currentState) {\n            if (!storyData.value || !storyData.value.结局 || !storyData.value.结局[endingName]) {\n                return;\n            }\n            const confirmTitle = currentState ? '取消完成条件' : '标记为已完成';\n            const confirmMessage = currentState\n                ? `确定要取消完成条件「${conditionName}」吗？`\n                : `确定要标记条件「${conditionName}」为已完成吗？`;\n            const dialog = document.createElement('div');\n            dialog.innerHTML = `\n    <div style=\"\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.7);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n    \">\n      <div style=\"\n        background: var(--card-bg-color, #1e1e2e);\n        border: 1px solid var(--border-color, #45475a);\n        border-radius: 12px;\n        padding: 24px;\n        min-width: 320px;\n        max-width: 90%;\n        color: var(--text-color, #cdd6f4);\n      \">\n        <h3 style=\"margin: 0 0 16px 0; font-size: 18px;\">${confirmTitle}</h3>\n        <p style=\"margin: 0 0 20px 0; color: var(--subtext-color, #a6adc8);\">${confirmMessage}</p>\n        <div style=\"display: flex; gap: 12px;\">\n          <button id=\"btn-confirm\" style=\"\n            flex: 1;\n            padding: 12px;\n            background: ${currentState ? 'var(--red, #f38ba8)' : 'var(--blue, #89b4fa)'};\n            color: #1e1e2e;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: 600;\n          \">${currentState ? '取消完成' : '确认完成'}</button>\n          <button id=\"btn-cancel\" style=\"\n            flex: 1;\n            padding: 12px;\n            background: var(--surface-color, #313244);\n            color: var(--text-color, #cdd6f4);\n            border: 1px solid var(--border-color, #45475a);\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: 600;\n          \">取消</button>\n        </div>\n      </div>\n    </div>\n  `;\n            document.body.appendChild(dialog);\n            dialog.querySelector('#btn-confirm')?.addEventListener('click', () => {\n                const updatedStoryData = {\n                    ...storyData.value,\n                    结局: {\n                        ...storyData.value.结局,\n                        [endingName]: {\n                            ...storyData.value.结局[endingName],\n                            达成条件: {\n                                ...storyData.value.结局[endingName].达成条件,\n                                [conditionName]: !currentState,\n                            },\n                        },\n                    },\n                };\n                dataStore.data.个人线 = {\n                    ...dataStore.data.个人线,\n                    [selectedStory.value]: updatedStoryData,\n                };\n                console.log('条件状态已更新:', {\n                    结局: endingName,\n                    条件: conditionName,\n                    新状态: !currentState,\n                });\n                document.body.removeChild(dialog);\n            });\n            dialog.querySelector('#btn-cancel')?.addEventListener('click', () => {\n                document.body.removeChild(dialog);\n            });\n            dialog.firstElementChild?.addEventListener('click', e => {\n                if (e.target === dialog.firstElementChild) {\n                    document.body.removeChild(dialog);\n                }\n            });\n        }\n        // 获取个人线显示状态（包含所有已完成结局）\n        const storyDisplayStatus = computed(() => {\n            if (!storyData.value) {\n                return '未知';\n            }\n            // 检查是否有已完成的结局\n            const completedEndings = Object.entries(storyData.value.结局 || {}).filter(([_, ending]) => {\n                return isEndingCompleted(ending);\n            });\n            if (completedEndings.length > 0) {\n                // 返回所有已完成结局的名称\n                const endingNames = completedEndings.map(([name]) => name).join('、');\n                return `已完成: ${endingNames}`;\n            }\n            // 否则返回原始状态\n            return storyData.value.状态 || '未开始';\n        });\n        // 获取用户数据\n        const userData = computed(() => dataStore.data.user || {\n            SkillPoint: 0,\n            Magic: 0,\n            MagicMax: 100,\n            Morality: 0,\n            SkillTree: {},\n        });\n        // 获取已学习的技能\n        const learnedSkills = computed(() => {\n            const skillTree = userData.value.SkillTree || {};\n            return Object.keys(skillTree).filter(skillName => skillTree[skillName].已学习);\n        });\n        // 获取状态样式类\n        function getStatusClass(status) {\n            switch (status) {\n                case '未开始':\n                    return 'status-not-started';\n                case '进行中':\n                    return 'status-in-progress';\n                case '已完成':\n                    return 'status-completed';\n                default:\n                    return 'status-unknown';\n            }\n        }\n        // 获取个人线状态样式类\n        function getStoryStatusClass() {\n            if (!storyData.value) {\n                return 'status-unknown';\n            }\n            // 检查是否有已完成的结局\n            const hasCompletedEnding = Object.entries(storyData.value.结局 || {}).some(([_, ending]) => {\n                return isEndingCompleted(ending);\n            });\n            if (hasCompletedEnding) {\n                return 'status-ending-completed';\n            }\n            return getStatusClass(storyData.value.状态 || '未开始');\n        }\n        // 主题切换\n        function toggleTheme() {\n            const currentTheme = document.body.getAttribute('data-theme');\n            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';\n            document.body.setAttribute('data-theme', newTheme);\n            localStorage.setItem('theme', newTheme);\n        }\n        // 处理导航事件\n        function handleNavigateEvent(event) {\n            const { page, charName, storyName } = event.detail;\n            navigateTo(page, charName || storyName);\n        }\n        // 初始化主题和事件监听器\n        onMounted(() => {\n            const savedTheme = localStorage.getItem('theme') || 'dark';\n            document.body.setAttribute('data-theme', savedTheme);\n            // 添加导航事件监听器\n            window.addEventListener('navigate', handleNavigateEvent);\n        });\n        // 清理事件监听器\n        onUnmounted(() => {\n            window.removeEventListener('navigate', handleNavigateEvent);\n        });\n        return (_ctx, _cache) => {\n            const _component_UserPanel = _resolveComponent(\"UserPanel\");\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" 主题切换按钮 \"),\n                _createElementVNode(\"button\", {\n                    id: \"theme-toggle-btn\",\n                    title: \"切换主题\",\n                    onClick: toggleTheme\n                }, [...(_cache[16] || (_cache[16] = [\n                        _createElementVNode(\"i\", { class: \"fas fa-sun\" }, null, -1 /* CACHED */),\n                        _createElementVNode(\"i\", { class: \"fas fa-moon\" }, null, -1 /* CACHED */)\n                    ]))]),\n                _createCommentVNode(\" 主菜单页面 \"),\n                (currentPage.value === 'main')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"section\", _hoisted_3, [\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _cache[17] || (_cache[17] = _createElementVNode(\"i\", { class: \"fas fa-calendar\" }, null, -1 /* CACHED */)),\n                                _cache[18] || (_cache[18] = _createElementVNode(\"strong\", null, \"日期：\", -1 /* CACHED */)),\n                                _createTextVNode(_toDisplayString(_unref(dataStore).data.当前时间 ? _unref(dataStore).data.当前时间.split(' ')[0] : '未知'), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_5, [\n                                _cache[19] || (_cache[19] = _createElementVNode(\"i\", { class: \"fas fa-clock\" }, null, -1 /* CACHED */)),\n                                _cache[20] || (_cache[20] = _createElementVNode(\"strong\", null, \"时间：\", -1 /* CACHED */)),\n                                _createTextVNode(_toDisplayString(_unref(dataStore).data.当前时间 ? _unref(dataStore).data.当前时间.split(' ')[1] : '未知'), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                _cache[21] || (_cache[21] = _createElementVNode(\"i\", { class: \"fas fa-map-marker-alt\" }, null, -1 /* CACHED */)),\n                                _cache[22] || (_cache[22] = _createElementVNode(\"strong\", null, \"地点：\", -1 /* CACHED */)),\n                                _createTextVNode(_toDisplayString(_unref(dataStore).data.location || '未知'), 1 /* TEXT */)\n                            ])\n                        ]),\n                        _cache[27] || (_cache[27] = _createElementVNode(\"div\", { class: \"block-title\" }, [\n                            _createElementVNode(\"i\", { class: \"fas fa-bars\" }),\n                            _createTextVNode(\"主菜单\")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            _createElementVNode(\"button\", {\n                                class: \"menu-btn\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (navigateTo('characters')))\n                            }, [...(_cache[23] || (_cache[23] = [\n                                    _createElementVNode(\"i\", { class: \"fas fa-users\" }, null, -1 /* CACHED */),\n                                    _createTextVNode(\" 在场角色\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"button\", {\n                                class: \"menu-btn\",\n                                onClick: _cache[1] || (_cache[1] = ($event) => (navigateTo('archive')))\n                            }, [...(_cache[24] || (_cache[24] = [\n                                    _createElementVNode(\"i\", { class: \"fas fa-address-book\" }, null, -1 /* CACHED */),\n                                    _createTextVNode(\" 角色档案\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"button\", {\n                                class: \"menu-btn\",\n                                onClick: _cache[2] || (_cache[2] = ($event) => (navigateTo('terminal')))\n                            }, [...(_cache[25] || (_cache[25] = [\n                                    _createElementVNode(\"i\", { class: \"fas fa-laptop-code\" }, null, -1 /* CACHED */),\n                                    _createTextVNode(\" 我的终端\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"button\", {\n                                class: \"menu-btn\",\n                                onClick: _cache[3] || (_cache[3] = ($event) => (navigateTo('story')))\n                            }, [...(_cache[26] || (_cache[26] = [\n                                    _createElementVNode(\"i\", { class: \"fas fa-book\" }, null, -1 /* CACHED */),\n                                    _createTextVNode(\" 个人线\", -1 /* CACHED */)\n                                ]))])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" 角色档案页面 \"),\n                (currentPage.value === 'archive')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                        _createElementVNode(\"button\", {\n                            class: \"back-btn view-btn\",\n                            onClick: _cache[4] || (_cache[4] = ($event) => (navigateTo('main')))\n                        }, [...(_cache[28] || (_cache[28] = [\n                                _createElementVNode(\"i\", { class: \"fas fa-arrow-left\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 返回\", -1 /* CACHED */)\n                            ]))]),\n                        _cache[29] || (_cache[29] = _createElementVNode(\"div\", { class: \"block-title\" }, [\n                            _createElementVNode(\"i\", { class: \"fas fa-address-book\" }),\n                            _createTextVNode(\" 角色档案\")\n                        ], -1 /* CACHED */)),\n                        _createVNode(CharacterArchivePanel, {\n                            onViewCharacter: _cache[5] || (_cache[5] = ($event) => (navigateTo('character-detail', $event)))\n                        })\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" 我的终端页面 \"),\n                (currentPage.value === 'terminal')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                        _createElementVNode(\"button\", {\n                            class: \"back-btn view-btn\",\n                            onClick: _cache[6] || (_cache[6] = ($event) => (navigateTo('main')))\n                        }, [...(_cache[30] || (_cache[30] = [\n                                _createElementVNode(\"i\", { class: \"fas fa-arrow-left\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 返回\", -1 /* CACHED */)\n                            ]))]),\n                        _cache[40] || (_cache[40] = _createElementVNode(\"div\", { class: \"block-title\" }, [\n                            _createElementVNode(\"i\", { class: \"fas fa-laptop-code\" }),\n                            _createTextVNode(\" 我的终端\")\n                        ], -1 /* CACHED */)),\n                        _createCommentVNode(\" 个人状态 \"),\n                        _createElementVNode(\"div\", _hoisted_10, [\n                            _createElementVNode(\"div\", _hoisted_11, [\n                                _createElementVNode(\"div\", _hoisted_12, [\n                                    _cache[32] || (_cache[32] = _createElementVNode(\"span\", { class: \"stat-icon\" }, \"⭐\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_13, [\n                                        _createElementVNode(\"span\", _hoisted_14, _toDisplayString(userData.value.SkillPoint), 1 /* TEXT */),\n                                        _cache[31] || (_cache[31] = _createElementVNode(\"span\", { class: \"stat-label\" }, \"侵蚀点\", -1 /* CACHED */))\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_15, [\n                                    _cache[34] || (_cache[34] = _createElementVNode(\"span\", { class: \"stat-icon\" }, \"💎\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_16, [\n                                        _createElementVNode(\"span\", _hoisted_17, _toDisplayString(userData.value.Magic) + \"/\" + _toDisplayString(userData.value.MagicMax), 1 /* TEXT */),\n                                        _cache[33] || (_cache[33] = _createElementVNode(\"span\", { class: \"stat-label\" }, \"魔力值\", -1 /* CACHED */))\n                                    ])\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_18, [\n                                    _cache[36] || (_cache[36] = _createElementVNode(\"span\", { class: \"stat-icon\" }, \"⚖️\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_19, [\n                                        _createElementVNode(\"span\", {\n                                            class: _normalizeClass([\"stat-value\", { positive: userData.value.Morality >= 0, negative: userData.value.Morality < 0 }])\n                                        }, _toDisplayString(userData.value.Morality >= 0 ? '+' : '') + _toDisplayString(userData.value.Morality), 3 /* TEXT, CLASS */),\n                                        _cache[35] || (_cache[35] = _createElementVNode(\"span\", { class: \"stat-label\" }, \"善恶值\", -1 /* CACHED */))\n                                    ])\n                                ])\n                            ])\n                        ]),\n                        _createCommentVNode(\" 技能列表和学习技能入口 \"),\n                        _createElementVNode(\"div\", _hoisted_20, [\n                            _createElementVNode(\"div\", _hoisted_21, [\n                                _createElementVNode(\"button\", {\n                                    class: \"skill-card\",\n                                    onClick: _cache[7] || (_cache[7] = ($event) => (navigateTo('skillList')))\n                                }, [\n                                    _cache[38] || (_cache[38] = _createElementVNode(\"div\", { class: \"skill-card-icon\" }, [\n                                        _createElementVNode(\"svg\", {\n                                            width: \"48\",\n                                            height: \"48\",\n                                            viewBox: \"0 0 24 24\",\n                                            fill: \"none\",\n                                            stroke: \"currentColor\",\n                                            \"stroke-width\": \"2\",\n                                            \"stroke-linecap\": \"round\",\n                                            \"stroke-linejoin\": \"round\"\n                                        }, [\n                                            _createElementVNode(\"path\", { d: \"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20\" })\n                                        ])\n                                    ], -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_22, [\n                                        _cache[37] || (_cache[37] = _createElementVNode(\"div\", { class: \"skill-card-title\" }, \"技能列表\", -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_23, \"(\" + _toDisplayString(learnedSkills.value.length) + \")\", 1 /* TEXT */)\n                                    ])\n                                ]),\n                                _createElementVNode(\"button\", {\n                                    class: \"skill-card\",\n                                    onClick: _cache[8] || (_cache[8] = ($event) => (navigateTo('learnSkills')))\n                                }, [...(_cache[39] || (_cache[39] = [\n                                        _createStaticVNode(\"<div class=\\\"skill-card-icon\\\" data-v-60888edd><svg width=\\\"48\\\" height=\\\"48\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" data-v-60888edd><path d=\\\"M22 10v6M2 10l10-5 10 5-10 5z\\\" data-v-60888edd></path><path d=\\\"M6 12v5c3 3 9 3 12 0v-5\\\" data-v-60888edd></path></svg></div><div class=\\\"skill-card-text\\\" data-v-60888edd><div class=\\\"skill-card-title\\\" data-v-60888edd>学习技能</div></div>\", 2)\n                                    ]))])\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" 技能列表页面 \"),\n                (currentPage.value === 'skillList')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_24, [\n                        _createElementVNode(\"button\", {\n                            class: \"back-btn view-btn\",\n                            onClick: _cache[9] || (_cache[9] = ($event) => (navigateTo('terminal')))\n                        }, [...(_cache[41] || (_cache[41] = [\n                                _createElementVNode(\"i\", { class: \"fas fa-arrow-left\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 返回\", -1 /* CACHED */)\n                            ]))]),\n                        _createElementVNode(\"div\", _hoisted_25, [\n                            (_openBlock(), _createElementBlock(\"svg\", _hoisted_26, [...(_cache[42] || (_cache[42] = [\n                                    _createElementVNode(\"path\", { d: \"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20\" }, null, -1 /* CACHED */)\n                                ]))])),\n                            _cache[43] || (_cache[43] = _createTextVNode(\" 技能列表 \", -1 /* CACHED */))\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_27, [\n                            (learnedSkills.value.length === 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_28, [...(_cache[44] || (_cache[44] = [\n                                        _createElementVNode(\"p\", null, \"暂未学习任何技能\", -1 /* CACHED */)\n                                    ]))]))\n                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_29, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(learnedSkills.value, (skillName) => {\n                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                            key: skillName,\n                                            class: \"learned-skill-item\"\n                                        }, [\n                                            _createElementVNode(\"div\", _hoisted_30, [\n                                                _cache[45] || (_cache[45] = _createElementVNode(\"div\", { class: \"skill-check\" }, [\n                                                    _createElementVNode(\"svg\", {\n                                                        width: \"20\",\n                                                        height: \"20\",\n                                                        viewBox: \"0 0 24 24\",\n                                                        fill: \"currentColor\",\n                                                        stroke: \"currentColor\",\n                                                        \"stroke-width\": \"2\",\n                                                        \"stroke-linecap\": \"round\",\n                                                        \"stroke-linejoin\": \"round\"\n                                                    }, [\n                                                        _createElementVNode(\"polyline\", { points: \"20 6 9 17 4 12\" })\n                                                    ])\n                                                ], -1 /* CACHED */)),\n                                                _createElementVNode(\"div\", _hoisted_31, _toDisplayString(skillName), 1 /* TEXT */),\n                                                _cache[46] || (_cache[46] = _createElementVNode(\"div\", { class: \"skill-status\" }, \"已掌握\", -1 /* CACHED */))\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_32, _toDisplayString(userData.value.SkillTree[skillName].描述), 1 /* TEXT */)\n                                        ]));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]))\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" 学习技能页面 \"),\n                (currentPage.value === 'learnSkills')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_33, [\n                        _createElementVNode(\"button\", {\n                            class: \"back-btn view-btn\",\n                            onClick: _cache[10] || (_cache[10] = ($event) => (navigateTo('terminal')))\n                        }, [...(_cache[47] || (_cache[47] = [\n                                _createElementVNode(\"i\", { class: \"fas fa-arrow-left\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 返回\", -1 /* CACHED */)\n                            ]))]),\n                        _cache[48] || (_cache[48] = _createElementVNode(\"div\", { class: \"block-title\" }, [\n                            _createElementVNode(\"i\", { class: \"fas fa-graduation-cap\" }),\n                            _createTextVNode(\" 学习技能\")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_34, [\n                            _createVNode(SkillsPanel)\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" 在场角色页面 \"),\n                (currentPage.value === 'characters')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_35, [\n                        _createElementVNode(\"button\", {\n                            class: \"back-btn view-btn\",\n                            onClick: _cache[11] || (_cache[11] = ($event) => (navigateTo('main')))\n                        }, [...(_cache[49] || (_cache[49] = [\n                                _createElementVNode(\"i\", { class: \"fas fa-arrow-left\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 返回\", -1 /* CACHED */)\n                            ]))]),\n                        _cache[50] || (_cache[50] = _createElementVNode(\"div\", { class: \"block-title\" }, [\n                            _createElementVNode(\"i\", { class: \"fas fa-users\" }),\n                            _createTextVNode(\" 在场角色\")\n                        ], -1 /* CACHED */)),\n                        _createVNode(CharactersPanel)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" 用户状态页面 \"),\n                (currentPage.value === 'user')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_36, [\n                        _createElementVNode(\"button\", {\n                            class: \"back-btn view-btn\",\n                            onClick: _cache[12] || (_cache[12] = ($event) => (navigateTo('main')))\n                        }, [...(_cache[51] || (_cache[51] = [\n                                _createElementVNode(\"i\", { class: \"fas fa-arrow-left\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 返回\", -1 /* CACHED */)\n                            ]))]),\n                        _cache[52] || (_cache[52] = _createElementVNode(\"div\", { class: \"block-title\" }, [\n                            _createElementVNode(\"i\", { class: \"fas fa-user\" }),\n                            _createTextVNode(\" 用户状态\")\n                        ], -1 /* CACHED */)),\n                        _createVNode(_component_UserPanel)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" 个人线页面 \"),\n                (currentPage.value === 'story')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_37, [\n                        _createElementVNode(\"button\", {\n                            class: \"back-btn view-btn\",\n                            onClick: _cache[13] || (_cache[13] = ($event) => (navigateTo('main')))\n                        }, [...(_cache[53] || (_cache[53] = [\n                                _createElementVNode(\"i\", { class: \"fas fa-arrow-left\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 返回\", -1 /* CACHED */)\n                            ]))]),\n                        _cache[54] || (_cache[54] = _createElementVNode(\"div\", { class: \"block-title\" }, [\n                            _createElementVNode(\"i\", { class: \"fas fa-book\" }),\n                            _createTextVNode(\" 个人线\")\n                        ], -1 /* CACHED */)),\n                        _createVNode(StoryPanel)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" 个人线详情页面 \"),\n                (currentPage.value === 'story-detail')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_38, [\n                        _createElementVNode(\"button\", {\n                            class: \"back-btn view-btn\",\n                            onClick: _cache[14] || (_cache[14] = ($event) => (navigateTo('story')))\n                        }, [...(_cache[55] || (_cache[55] = [\n                                _createElementVNode(\"i\", { class: \"fas fa-arrow-left\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 返回\", -1 /* CACHED */)\n                            ]))]),\n                        _createElementVNode(\"div\", _hoisted_39, [\n                            _cache[56] || (_cache[56] = _createElementVNode(\"i\", { class: \"fas fa-book-open\" }, null, -1 /* CACHED */)),\n                            _createTextVNode(\" \" + _toDisplayString(selectedStory.value), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_40, [\n                            (!storyData.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_41, [...(_cache[57] || (_cache[57] = [\n                                        _createElementVNode(\"span\", null, \"加载个人线信息中...\", -1 /* CACHED */)\n                                    ]))]))\n                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_42, [\n                                    _createElementVNode(\"div\", _hoisted_43, [\n                                        _cache[58] || (_cache[58] = _createElementVNode(\"strong\", null, \"状态：\", -1 /* CACHED */)),\n                                        _createElementVNode(\"span\", {\n                                            class: _normalizeClass(getStoryStatusClass())\n                                        }, _toDisplayString(storyDisplayStatus.value), 3 /* TEXT, CLASS */)\n                                    ]),\n                                    (Object.keys(storyData.value.结局).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_44, [\n                                            _cache[61] || (_cache[61] = _createElementVNode(\"div\", { class: \"endings-title\" }, \"📚 结局\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_45, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(storyData.value.结局, (ending, endingName) => {\n                                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                                        key: endingName,\n                                                        class: _normalizeClass([\"ending-item\", { 'ending-completed': isEndingCompleted(ending) }])\n                                                    }, [\n                                                        _createElementVNode(\"div\", _hoisted_46, [\n                                                            _createElementVNode(\"span\", {\n                                                                class: _normalizeClass([\"ending-name\", { 'ending-name-completed': isEndingCompleted(ending) }])\n                                                            }, _toDisplayString(endingName), 3 /* TEXT, CLASS */),\n                                                            (isEndingCompleted(ending))\n                                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_47, \"✨ 已达成\"))\n                                                                : _createCommentVNode(\"v-if\", true)\n                                                        ]),\n                                                        _createCommentVNode(\" 结局说明 \"),\n                                                        (ending.说明)\n                                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_48, [\n                                                                _cache[59] || (_cache[59] = _createElementVNode(\"div\", { class: \"description-title\" }, \"说明\", -1 /* CACHED */)),\n                                                                _createElementVNode(\"p\", _hoisted_49, _toDisplayString(ending.说明), 1 /* TEXT */)\n                                                            ]))\n                                                            : _createCommentVNode(\"v-if\", true),\n                                                        (Object.keys(ending.达成条件).length > 0)\n                                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_50, [\n                                                                _cache[60] || (_cache[60] = _createElementVNode(\"div\", { class: \"conditions-title\" }, \"达成条件\", -1 /* CACHED */)),\n                                                                _createElementVNode(\"div\", _hoisted_51, [\n                                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(ending.达成条件, (condition, conditionName) => {\n                                                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                                                            key: conditionName,\n                                                                            class: _normalizeClass([\"condition-item\", { 'condition-met': condition }]),\n                                                                            onClick: ($event) => (toggleCondition(endingName, conditionName, condition))\n                                                                        }, [\n                                                                            _createElementVNode(\"span\", _hoisted_53, _toDisplayString(conditionName), 1 /* TEXT */),\n                                                                            _createElementVNode(\"span\", _hoisted_54, _toDisplayString(condition ? '✓' : '✗'), 1 /* TEXT */)\n                                                                        ], 10 /* CLASS, PROPS */, _hoisted_52));\n                                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                                ])\n                                                            ]))\n                                                            : _createCommentVNode(\"v-if\", true)\n                                                    ], 2 /* CLASS */));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_55, [...(_cache[62] || (_cache[62] = [\n                                                _createElementVNode(\"span\", { class: \"no-endings-text\" }, \"暂未达成任何结局\", -1 /* CACHED */)\n                                            ]))]))\n                                ]))\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" 角色详情页面 \"),\n                (currentPage.value === 'character-detail')\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_56, [\n                        _createElementVNode(\"button\", {\n                            class: \"back-btn view-btn\",\n                            onClick: _cache[15] || (_cache[15] = ($event) => (navigateTo(previousPage.value)))\n                        }, [...(_cache[63] || (_cache[63] = [\n                                _createElementVNode(\"i\", { class: \"fas fa-arrow-left\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 返回 \", -1 /* CACHED */)\n                            ]))]),\n                        _createElementVNode(\"div\", _hoisted_57, [\n                            _cache[64] || (_cache[64] = _createElementVNode(\"i\", { class: \"fas fa-user\" }, null, -1 /* CACHED */)),\n                            _createTextVNode(\" \" + _toDisplayString(selectedCharacter.value), 1 /* TEXT */)\n                        ]),\n                        _createVNode(CharacterDetailPanel, { characterName: selectedCharacter.value }, null, 8 /* PROPS */, [\"characterName\"])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=60888edd&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-60888edd\"]])\n\nexport default __exports__","import { waitUntil } from 'async-wait-until';\nimport App from './App.vue';\nimport './global.css';\nimport { initializeDefaultAvatars } from './avatarLibrary';\n$(async () => {\n    await waitGlobalInitialized('Mvu');\n    await waitUntil(() => _.has(getVariables({ type: 'message' }), 'stat_data'));\n    await initializeDefaultAvatars();\n    createApp(App).use(createPinia()).mount('#app');\n});\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","Vue","STORE_NAME","AVATAR_STATE_KEY","AVATAR_LIBRARY_KEY","defaultAvatarLibrary","default","defaultAvatarState","avatarLibrary","avatarState","isInitialized","db","openDatabase","Promise","resolve","reject","request","indexedDB","open","onerror","console","error","onsuccess","result","log","onupgradeneeded","event","database","objectStoreNames","contains","createObjectStore","async","loadFromIndexedDB","transaction","objectStore","get","saveToIndexedDB","data","put","getCharacterAvatarLibrary","characterName","defaultAvatars","nonZeroAvatarIds","Object","keys","map","Number","filter","id","length","firstAvatarId","Math","min","getCurrentAvatarId","current","getAvatarHistoryIds","history","avatarId","actualAvatarId","undefined","avatarUrl","initialAvatarData","initializeDefaultAvatars","savedLibrary","savedState","loadAvatarLibrary","entries","tryOnScopeDispose","fn","getCurrentScope","onScopeDispose","isClient","window","document","WorkerGlobalScope","globalThis","prototype","toString","createFilterWrapper","args","apply","this","thisArg","then","catch","bypassFilter","invoke","cacheStringFunction","cache","create","str","hyphenateRE","camelizeRE","replace","toLowerCase","_","c","toUpperCase","useIntervalFn","cb","interval","options","immediate","immediateCallback","timer","isActive","shallowRef","clean","clearInterval","pause","value","resume","intervalValue","toValue","setInterval","isRef","watch","shallowReadonly","watchIgnorable","source","eventFilter","watchOptions","filteredCb","ignoreUpdates","ignorePrevAsyncUpdates","stop","flush","ignore","updater","disposables","ignoreCounter","syncCounter","push","syncCounterPrev","forEach","z","CharacterStatsSchema","object","Favor","coerce","number","transform","v","clamp","prefault","Magic","MagicMax","Corruption","Description","array","string","SceneCharacterSchema","Thought","Action","State","isTransformed","boolean","Lust","Schema","location","record","describe","Enemies","any","Partners","user","SkillPoint","Morality","SkillTree","$","useDataStore","schema","variable_option","type","message_id","getCurrentMessageId","sortBy","entry","join","errorCatched","ref","parse","getVariables","reportInput","additional_setup","stat_data","safeParse","isEqual","updateVariablesWith","variables","set","new_data","deep","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","__name","emits","setup","__props","emit","__emit","dataStore","allCharacters","computed","presentCharacters","getAvatarUrl","isPresent","name","getPresenceClass","getPresenceText","handleImageError","img","style","display","placeholder","parentElement","querySelector","_ctx","_cache","character","onClick","$event","src","alt","onError","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","isAvatarOptionsDialogOpen","currentDialogElement","characterData","sceneData","currentAvatarId","avatarHistoryIds","currentAvatar","avatarHistory","handleHistoryImageError","classList","add","showAvatarOptions","dialog","createElement","charAvatarLibrary","innerHTML","url","parseInt","body","appendChild","element","addEventListener","removeChild","updateAvatar","deleteButton","e","stopPropagation","newHistory","firstElementChild","deleteAvatar","trim","addAvatarByUrl","showUrlInputDialog","input","accept","fileInput","file","files","maxSize","size","alert","reader","FileReader","onload","base64Url","readAsDataURL","click","showFileSelectorDialog","showAddAvatarDialog","newAvatarId","currentAvatarValue","includes","slice","setCurrentAvatarId","existingIds","max","getNextAvatarId","addAvatar","deleteHistoryAvatar","_avatar","index","removeFromHistory","avatar","active","find","title","width","abs","item","sceneCharacters","characterList","expandedCharacters","getCharacterAvatarUrl","charName","char","rotated","viewBox","fill","xmlns","d","upgradeAmount","userData","skillTree","canUpgrade","canLearn","skill","skillPoints","skillCost","upgradeMagicMax","currentSkillPoints","currentMagicMax","currentMagic","amount","newUserState","disabled","skillName","learned","cost","currentSkills","updatedSkills","newSkillPoints","skillCard","setTimeout","remove","storyLines","hasCompletedEnding","story","values","some","ending","every","condition","getCompletedEndingsCount","getStoryDisplayStatus","completedEndings","getStoryStatusClass","status","getStatusClass","storyName","completed","CustomEvent","detail","page","dispatchEvent","height","stroke","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","currentPage","selectedCharacter","selectedStory","previousPage","navigateTo","param","storyData","isEndingCompleted","conditions","storyDisplayStatus","learnedSkills","toggleTheme","newTheme","getAttribute","setAttribute","localStorage","setItem","handleNavigateEvent","onMounted","savedTheme","getItem","onUnmounted","removeEventListener","_component_UserPanel","split","CharacterArchivePanel","onViewCharacter","positive","negative","points","SkillsPanel","CharactersPanel","StoryPanel","endingName","conditionName","currentState","confirmTitle","confirmMessage","updatedStoryData","CharacterDetailPanel","waitGlobalInitialized","has","createApp","App","use","mount"],"sourceRoot":""}